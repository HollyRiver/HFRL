wandb: Detected [huggingface_hub.inference, openai] in use.
wandb: Use W&B Weave for improved LLM call tracing. Install Weave with `pip install weave` then add `import weave` to the top of your script.
wandb: For more information, check out the docs at: https://weave-docs.wandb.ai/
  0%|          | 0/6854 [00:00<?, ?it/s]Casting fp32 inputs back to torch.bfloat16 for flash-attn compatibility.
/root/miniconda3/envs/LLM/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|▏         | 100/6854 [08:26<9:57:07,  5.30s/it]
{'loss': 0.6927, 'grad_norm': 3.830328941345215, 'learning_rate': 1.2014563106796117e-07, 'rewards/chosen': 0.0019070291891694069, 'rewards/rejected': -0.00027457179385237396, 'rewards/accuracies': 0.48500001430511475, 'rewards/margins': 0.0021816014777868986, 'logps/chosen': -354.2372741699219, 'logps/rejected': -283.44183349609375, 'logits/chosen': -0.2444102168083191, 'logits/rejected': -0.3073667287826538, 'epoch': 0.03}
{'loss': 0.6917, 'grad_norm': 3.8958935737609863, 'learning_rate': 2.4150485436893205e-07, 'rewards/chosen': -0.00020426303672138602, 'rewards/rejected': -0.004452555440366268, 'rewards/accuracies': 0.48875001072883606, 'rewards/margins': 0.004248291719704866, 'logps/chosen': -328.7416076660156, 'logps/rejected': -290.120361328125, 'logits/chosen': -0.278245747089386, 'logits/rejected': -0.28958770632743835, 'epoch': 0.06}
{'loss': 0.6963, 'grad_norm': 3.6533429622650146, 'learning_rate': 3.6286407766990293e-07, 'rewards/chosen': -0.010095763951539993, 'rewards/rejected': -0.005308255087584257, 'rewards/accuracies': 0.4749999940395355, 'rewards/margins': -0.004787510260939598, 'logps/chosen': -330.7372741699219, 'logps/rejected': -275.77764892578125, 'logits/chosen': -0.2576887011528015, 'logits/rejected': -0.3049943149089813, 'epoch': 0.09}
{'loss': 0.6876, 'grad_norm': 3.5315160751342773, 'learning_rate': 4.842233009708738e-07, 'rewards/chosen': -0.008197813294827938, 'rewards/rejected': -0.02082744985818863, 'rewards/accuracies': 0.5674999952316284, 'rewards/margins': 0.012629636563360691, 'logps/chosen': -328.93963623046875, 'logps/rejected': -287.8960876464844, 'logits/chosen': -0.2900310158729553, 'logits/rejected': -0.34940624237060547, 'epoch': 0.12}
  7%|▋         | 500/6854 [40:43<8:45:05,  4.96s/it]
100%|██████████| 762/762 [15:27<00:00,  1.08s/it]
{'eval_loss': 0.6776479482650757, 'eval_runtime': 929.3767, 'eval_samples_per_second': 3.277, 'eval_steps_per_second': 0.82, 'eval_rewards/chosen': -0.02220395766198635, 'eval_rewards/rejected': -0.055812690407037735, 'eval_rewards/accuracies': 0.634186327457428, 'eval_rewards/margins': 0.033608730882406235, 'eval_logps/chosen': -327.6163635253906, 'eval_logps/rejected': -274.5284729003906, 'eval_logits/chosen': -0.2812737226486206, 'eval_logits/rejected': -0.3367173671722412, 'epoch': 0.15}
{'loss': 0.6715, 'grad_norm': 3.7571303844451904, 'learning_rate': 4.99065039993038e-07, 'rewards/chosen': -0.029785923659801483, 'rewards/rejected': -0.07665742188692093, 'rewards/accuracies': 0.6549999713897705, 'rewards/margins': 0.046871498227119446, 'logps/chosen': -342.65972900390625, 'logps/rejected': -284.217041015625, 'logits/chosen': -0.30514538288116455, 'logits/rejected': -0.3506675064563751, 'epoch': 0.18}
{'loss': 0.6666, 'grad_norm': 3.727517604827881, 'learning_rate': 4.97799782883342e-07, 'rewards/chosen': -0.06931685656309128, 'rewards/rejected': -0.12920251488685608, 'rewards/accuracies': 0.6825000047683716, 'rewards/margins': 0.0598856657743454, 'logps/chosen': -332.37359619140625, 'logps/rejected': -294.2916259765625, 'logits/chosen': -0.2832641303539276, 'logits/rejected': -0.3434111773967743, 'epoch': 0.2}
{'loss': 0.6475, 'grad_norm': 3.9493048191070557, 'learning_rate': 4.960047562215398e-07, 'rewards/chosen': -0.09103110432624817, 'rewards/rejected': -0.19385047256946564, 'rewards/accuracies': 0.7287499904632568, 'rewards/margins': 0.10281938314437866, 'logps/chosen': -333.7363586425781, 'logps/rejected': -278.0492248535156, 'logits/chosen': -0.29629331827163696, 'logits/rejected': -0.35275784134864807, 'epoch': 0.23}
{'loss': 0.652, 'grad_norm': 3.653933048248291, 'learning_rate': 4.936842281916408e-07, 'rewards/chosen': -0.14386311173439026, 'rewards/rejected': -0.24246738851070404, 'rewards/accuracies': 0.6612499952316284, 'rewards/margins': 0.09860426187515259, 'logps/chosen': -322.1383056640625, 'logps/rejected': -279.8827209472656, 'logits/chosen': -0.2990732491016388, 'logits/rejected': -0.33956679701805115, 'epoch': 0.26}
{'loss': 0.6308, 'grad_norm': 3.694575309753418, 'learning_rate': 4.908437165059117e-07, 'rewards/chosen': -0.14255665242671967, 'rewards/rejected': -0.2931864261627197, 'rewards/accuracies': 0.7149999737739563, 'rewards/margins': 0.15062974393367767, 'logps/chosen': -337.10797119140625, 'logps/rejected': -281.67657470703125, 'logits/chosen': -0.29769042134284973, 'logits/rejected': -0.3401239514350891, 'epoch': 0.29}
{'eval_loss': 0.6242654919624329, 'eval_runtime': 927.5245, 'eval_samples_per_second': 3.284, 'eval_steps_per_second': 0.822, 'eval_rewards/chosen': -0.15865854918956757, 'eval_rewards/rejected': -0.3237324655056, 'eval_rewards/accuracies': 0.720800518989563, 'eval_rewards/margins': 0.1650739312171936, 'eval_logps/chosen': -328.9809265136719, 'eval_logps/rejected': -277.2076721191406, 'eval_logits/chosen': -0.27884942293167114, 'eval_logits/rejected': -0.33365705609321594, 'epoch': 0.29}
{'loss': 0.6141, 'grad_norm': 4.465611457824707, 'learning_rate': 4.874899752849537e-07, 'rewards/chosen': -0.18315736949443817, 'rewards/rejected': -0.3732635974884033, 'rewards/accuracies': 0.7475000023841858, 'rewards/margins': 0.19010621309280396, 'logps/chosen': -352.7743835449219, 'logps/rejected': -303.71160888671875, 'logits/chosen': -0.30242669582366943, 'logits/rejected': -0.3580797612667084, 'epoch': 0.32}
{'loss': 0.6037, 'grad_norm': 4.182244300842285, 'learning_rate': 4.836309789978688e-07, 'rewards/chosen': -0.21027565002441406, 'rewards/rejected': -0.4344356060028076, 'rewards/accuracies': 0.7524999976158142, 'rewards/margins': 0.22415997087955475, 'logps/chosen': -329.857421875, 'logps/rejected': -275.7123107910156, 'logits/chosen': -0.28181397914886475, 'logits/rejected': -0.3264089822769165, 'epoch': 0.35}
{'loss': 0.5974, 'grad_norm': 4.16940975189209, 'learning_rate': 4.792759035007018e-07, 'rewards/chosen': -0.24549826979637146, 'rewards/rejected': -0.501882016658783, 'rewards/accuracies': 0.7337499856948853, 'rewards/margins': 0.2563837170600891, 'logps/chosen': -321.9544982910156, 'logps/rejected': -265.164794921875, 'logits/chosen': -0.3163530230522156, 'logits/rejected': -0.34321579337120056, 'epoch': 0.38}
{'loss': 0.5905, 'grad_norm': 3.0817017555236816, 'learning_rate': 4.744351042182457e-07, 'rewards/chosen': -0.266135036945343, 'rewards/rejected': -0.5465091466903687, 'rewards/accuracies': 0.7275000214576721, 'rewards/margins': 0.28037407994270325, 'logps/chosen': -342.21343994140625, 'logps/rejected': -291.6855163574219, 'logits/chosen': -0.303689181804657, 'logits/rejected': -0.3282882273197174, 'epoch': 0.41}
{'loss': 0.5704, 'grad_norm': 3.4581737518310547, 'learning_rate': 4.691200915210875e-07, 'rewards/chosen': -0.28414300084114075, 'rewards/rejected': -0.6287516355514526, 'rewards/accuracies': 0.7462499737739563, 'rewards/margins': 0.3446086049079895, 'logps/chosen': -312.958740234375, 'logps/rejected': -292.7357177734375, 'logits/chosen': -0.2651767432689667, 'logits/rejected': -0.34681499004364014, 'epoch': 0.44}
{'eval_loss': 0.5713275671005249, 'eval_runtime': 929.6132, 'eval_samples_per_second': 3.277, 'eval_steps_per_second': 0.82, 'eval_rewards/chosen': -0.28846609592437744, 'eval_rewards/rejected': -0.6335886716842651, 'eval_rewards/accuracies': 0.7477034330368042, 'eval_rewards/margins': 0.34512263536453247, 'eval_logps/chosen': -330.27899169921875, 'eval_logps/rejected': -280.30621337890625, 'eval_logits/chosen': -0.2766761779785156, 'eval_logits/rejected': -0.33061686158180237, 'epoch': 0.44}
{'loss': 0.5542, 'grad_norm': 4.140435695648193, 'learning_rate': 4.633435033564442e-07, 'rewards/chosen': -0.28541791439056396, 'rewards/rejected': -0.6934607028961182, 'rewards/accuracies': 0.78125, 'rewards/margins': 0.4080428183078766, 'logps/chosen': -350.59259033203125, 'logps/rejected': -293.1632995605469, 'logits/chosen': -0.27507561445236206, 'logits/rejected': -0.3371042013168335, 'epoch': 0.47}
{'loss': 0.5504, 'grad_norm': 4.487457752227783, 'learning_rate': 4.5711907519786535e-07, 'rewards/chosen': -0.3180426061153412, 'rewards/rejected': -0.7366818785667419, 'rewards/accuracies': 0.7662500143051147, 'rewards/margins': 0.41863933205604553, 'logps/chosen': -326.626220703125, 'logps/rejected': -292.15045166015625, 'logits/chosen': -0.2696171998977661, 'logits/rejected': -0.3076070547103882, 'epoch': 0.5}
{'loss': 0.5593, 'grad_norm': 3.3687169551849365, 'learning_rate': 4.504616073852573e-07, 'rewards/chosen': -0.338286429643631, 'rewards/rejected': -0.765093207359314, 'rewards/accuracies': 0.7425000071525574, 'rewards/margins': 0.42680680751800537, 'logps/chosen': -340.9571533203125, 'logps/rejected': -295.1044006347656, 'logits/chosen': -0.2637297511100769, 'logits/rejected': -0.31300023198127747, 'epoch': 0.53}
{'loss': 0.5421, 'grad_norm': 3.5404512882232666, 'learning_rate': 4.433869299328848e-07, 'rewards/chosen': -0.3088463842868805, 'rewards/rejected': -0.7740339040756226, 'rewards/accuracies': 0.7612500190734863, 'rewards/margins': 0.4651874899864197, 'logps/chosen': -319.6972351074219, 'logps/rejected': -277.4617004394531, 'logits/chosen': -0.28262367844581604, 'logits/rejected': -0.31710827350616455, 'epoch': 0.55}
{'loss': 0.5372, 'grad_norm': 4.473999977111816, 'learning_rate': 4.359118648890314e-07, 'rewards/chosen': -0.31554245948791504, 'rewards/rejected': -0.8060901761054993, 'rewards/accuracies': 0.7737500071525574, 'rewards/margins': 0.4905478358268738, 'logps/chosen': -348.5112609863281, 'logps/rejected': -306.8213806152344, 'logits/chosen': -0.26995912194252014, 'logits/rejected': -0.3511609733104706, 'epoch': 0.58}
{'eval_loss': 0.532473087310791, 'eval_runtime': 930.655, 'eval_samples_per_second': 3.273, 'eval_steps_per_second': 0.819, 'eval_rewards/chosen': -0.31282082200050354, 'eval_rewards/rejected': -0.8243103623390198, 'eval_rewards/accuracies': 0.7670603394508362, 'eval_rewards/margins': 0.5114895701408386, 'eval_logps/chosen': -330.52252197265625, 'eval_logps/rejected': -282.2134704589844, 'eval_logits/chosen': -0.2754996716976166, 'eval_logits/rejected': -0.32887575030326843, 'epoch': 0.58}
{'loss': 0.5274, 'grad_norm': 3.643509864807129, 'learning_rate': 4.28054186336818e-07, 'rewards/chosen': -0.3044014275074005, 'rewards/rejected': -0.8510199189186096, 'rewards/accuracies': 0.7599999904632568, 'rewards/margins': 0.5466185212135315, 'logps/chosen': -350.04803466796875, 'logps/rejected': -297.31146240234375, 'logits/chosen': -0.2890793979167938, 'logits/rejected': -0.3360302448272705, 'epoch': 0.61}
{'loss': 0.5342, 'grad_norm': 4.84860372543335, 'learning_rate': 4.1983257813128836e-07, 'rewards/chosen': -0.31466373801231384, 'rewards/rejected': -0.8417572975158691, 'rewards/accuracies': 0.7512500286102295, 'rewards/margins': 0.5270935297012329, 'logps/chosen': -333.9156494140625, 'logps/rejected': -291.4346923828125, 'logits/chosen': -0.31698930263519287, 'logits/rejected': -0.3703845739364624, 'epoch': 0.64}
{'loss': 0.5199, 'grad_norm': 4.097226619720459, 'learning_rate': 4.112665894732553e-07, 'rewards/chosen': -0.28891196846961975, 'rewards/rejected': -0.8550622463226318, 'rewards/accuracies': 0.7712500095367432, 'rewards/margins': 0.5661503076553345, 'logps/chosen': -320.61566162109375, 'logps/rejected': -291.14874267578125, 'logits/chosen': -0.3018859624862671, 'logits/rejected': -0.32412251830101013, 'epoch': 0.67}
{'loss': 0.5055, 'grad_norm': 5.299371719360352, 'learning_rate': 4.023765884255418e-07, 'rewards/chosen': -0.26942336559295654, 'rewards/rejected': -0.9022268652915955, 'rewards/accuracies': 0.7712500095367432, 'rewards/margins': 0.6328035593032837, 'logps/chosen': -349.810302734375, 'logps/rejected': -301.027099609375, 'logits/chosen': -0.2661663889884949, 'logits/rejected': -0.3014625310897827, 'epoch': 0.7}
{'loss': 0.4881, 'grad_norm': 3.7199268341064453, 'learning_rate': 3.931837134821461e-07, 'rewards/chosen': -0.23215430974960327, 'rewards/rejected': -0.9402368068695068, 'rewards/accuracies': 0.7987499833106995, 'rewards/margins': 0.7080824375152588, 'logps/chosen': -341.370849609375, 'logps/rejected': -303.83233642578125, 'logits/chosen': -0.2984626889228821, 'logits/rejected': -0.3343642055988312, 'epoch': 0.73}
{'eval_loss': 0.502045750617981, 'eval_runtime': 909.3847, 'eval_samples_per_second': 3.35, 'eval_steps_per_second': 0.838, 'eval_rewards/chosen': -0.26419535279273987, 'eval_rewards/rejected': -0.9329665899276733, 'eval_rewards/accuracies': 0.7824802994728088, 'eval_rewards/margins': 0.6687712073326111, 'eval_logps/chosen': -330.0362854003906, 'eval_logps/rejected': -283.29998779296875, 'eval_logits/chosen': -0.27682968974113464, 'eval_logits/rejected': -0.3296467661857605, 'epoch': 0.73}
{'loss': 0.475, 'grad_norm': 4.317683219909668, 'learning_rate': 3.8370982330548824e-07, 'rewards/chosen': -0.19425079226493835, 'rewards/rejected': -0.9218597412109375, 'rewards/accuracies': 0.8087499737739563, 'rewards/margins': 0.7276089191436768, 'logps/chosen': -334.8995361328125, 'logps/rejected': -284.3638000488281, 'logits/chosen': -0.251918226480484, 'logits/rejected': -0.278825581073761, 'epoch': 0.76}
{'loss': 0.5006, 'grad_norm': 4.953145503997803, 'learning_rate': 3.73977444751253e-07, 'rewards/chosen': -0.22831888496875763, 'rewards/rejected': -0.9513364434242249, 'rewards/accuracies': 0.7825000286102295, 'rewards/margins': 0.7230175733566284, 'logps/chosen': -328.89178466796875, 'logps/rejected': -281.620361328125, 'logits/chosen': -0.2906772494316101, 'logits/rejected': -0.35048794746398926, 'epoch': 0.79}
{'loss': 0.4975, 'grad_norm': 5.661382675170898, 'learning_rate': 3.640097193044135e-07, 'rewards/chosen': -0.26166221499443054, 'rewards/rejected': -1.0081866979599, 'rewards/accuracies': 0.7749999761581421, 'rewards/margins': 0.7465245127677917, 'logps/chosen': -326.23388671875, 'logps/rejected': -287.53057861328125, 'logits/chosen': -0.23622065782546997, 'logits/rejected': -0.3124620318412781, 'epoch': 0.82}

{'loss': 0.5009, 'grad_norm': 4.757793426513672, 'learning_rate': 3.538303480538e-07, 'rewards/chosen': -0.2632066607475281, 'rewards/rejected': -1.0019983053207397, 'rewards/accuracies': 0.7524999976158142, 'rewards/margins': 0.7387917041778564, 'logps/chosen': -333.09124755859375, 'logps/rejected': -288.9463806152344, 'logits/chosen': -0.2782971262931824, 'logits/rejected': -0.29931503534317017, 'epoch': 0.85}
{'loss': 0.4937, 'grad_norm': 3.2416677474975586, 'learning_rate': 3.4346353533605227e-07, 'rewards/chosen': -0.1747703105211258, 'rewards/rejected': -0.9350430369377136, 'rewards/accuracies': 0.7787500023841858, 'rewards/margins': 0.7602728009223938, 'logps/chosen': -328.853271484375, 'logps/rejected': -282.5958251953125, 'logits/chosen': -0.29021725058555603, 'logits/rejected': -0.3215848207473755, 'epoch': 0.88}
{'eval_loss': 0.4769676923751831, 'eval_runtime': 936.9784, 'eval_samples_per_second': 3.251, 'eval_steps_per_second': 0.813, 'eval_rewards/chosen': -0.18383345007896423, 'eval_rewards/rejected': -1.0043518543243408, 'eval_rewards/accuracies': 0.788385808467865, 'eval_rewards/margins': 0.8205183744430542, 'eval_logps/chosen': -329.2326965332031, 'eval_logps/rejected': -284.0138854980469, 'eval_logits/chosen': -0.2770211398601532, 'eval_logits/rejected': -0.3295409381389618, 'epoch': 0.88}
{'loss': 0.4807, 'grad_norm': 2.490712881088257, 'learning_rate': 3.329339311829574e-07, 'rewards/chosen': -0.15683074295520782, 'rewards/rejected': -0.9874099493026733, 'rewards/accuracies': 0.7987499833106995, 'rewards/margins': 0.8305792212486267, 'logps/chosen': -328.64959716796875, 'logps/rejected': -280.4545593261719, 'logits/chosen': -0.2873348891735077, 'logits/rejected': -0.31121909618377686, 'epoch': 0.9}
{'loss': 0.4549, 'grad_norm': 4.859245777130127, 'learning_rate': 3.222665727090218e-07, 'rewards/chosen': -0.09155318886041641, 'rewards/rejected': -1.025161862373352, 'rewards/accuracies': 0.7962499856948853, 'rewards/margins': 0.9336085319519043, 'logps/chosen': -323.7530517578125, 'logps/rejected': -283.5190124511719, 'logits/chosen': -0.30736029148101807, 'logits/rejected': -0.3533221185207367, 'epoch': 0.93}
{'loss': 0.4655, 'grad_norm': 4.838589191436768, 'learning_rate': 3.1148682457864395e-07, 'rewards/chosen': -0.14437541365623474, 'rewards/rejected': -1.0754809379577637, 'rewards/accuracies': 0.7962499856948853, 'rewards/margins': 0.9311054944992065, 'logps/chosen': -331.8628845214844, 'logps/rejected': -287.4506530761719, 'logits/chosen': -0.25394806265830994, 'logits/rejected': -0.3070232570171356, 'epoch': 0.96}
{'loss': 0.4394, 'grad_norm': 3.7514657974243164, 'learning_rate': 3.0062031869444493e-07, 'rewards/chosen': -0.0378173366189003, 'rewards/rejected': -1.0247199535369873, 'rewards/accuracies': 0.8075000047683716, 'rewards/margins': 0.9869025945663452, 'logps/chosen': -343.8547668457031, 'logps/rejected': -291.1170654296875, 'logits/chosen': -0.30568134784698486, 'logits/rejected': -0.35420599579811096, 'epoch': 0.99}
{'loss': 0.4499, 'grad_norm': 4.140172958374023, 'learning_rate': 2.896928932501641e-07, 'rewards/chosen': -0.08498352020978928, 'rewards/rejected': -1.0496344566345215, 'rewards/accuracies': 0.800000011920929, 'rewards/margins': 0.9646508693695068, 'logps/chosen': -332.0762634277344, 'logps/rejected': -294.4149475097656, 'logits/chosen': -0.29965388774871826, 'logits/rejected': -0.32174167037010193, 'epoch': 1.02}
{'eval_loss': 0.4548483192920685, 'eval_runtime': 946.4406, 'eval_samples_per_second': 3.218, 'eval_steps_per_second': 0.805, 'eval_rewards/chosen': -0.039489008486270905, 'eval_rewards/rejected': -1.0085501670837402, 'eval_rewards/accuracies': 0.7949475049972534, 'eval_rewards/margins': 0.9690612554550171, 'eval_logps/chosen': -327.7892150878906, 'eval_logps/rejected': -284.05584716796875, 'eval_logits/chosen': -0.28020188212394714, 'eval_logits/rejected': -0.332408607006073, 'epoch': 1.02}
{'loss': 0.429, 'grad_norm': 20.1502742767334, 'learning_rate': 2.7873053129303955e-07, 'rewards/chosen': 0.058333005756139755, 'rewards/rejected': -1.0083738565444946, 'rewards/accuracies': 0.8237500190734863, 'rewards/margins': 1.066706895828247, 'logps/chosen': -336.4794006347656, 'logps/rejected': -296.99517822265625, 'logits/chosen': -0.2864623963832855, 'logits/rejected': -0.316547691822052, 'epoch': 1.05}
{'loss': 0.4447, 'grad_norm': 7.046754837036133, 'learning_rate': 2.67759298941758e-07, 'rewards/chosen': 0.0022687185555696487, 'rewards/rejected': -1.0101929903030396, 'rewards/accuracies': 0.8100000023841858, 'rewards/margins': 1.0124619007110596, 'logps/chosen': -335.61297607421875, 'logps/rejected': -296.4501037597656, 'logits/chosen': -0.322988361120224, 'logits/rejected': -0.34391212463378906, 'epoch': 1.08}
{'loss': 0.4383, 'grad_norm': 2.4341342449188232, 'learning_rate': 2.568052834068798e-07, 'rewards/chosen': 0.012123248539865017, 'rewards/rejected': -1.0591034889221191, 'rewards/accuracies': 0.8100000023841858, 'rewards/margins': 1.0712265968322754, 'logps/chosen': -330.245361328125, 'logps/rejected': -303.7284240722656, 'logits/chosen': -0.27244436740875244, 'logits/rejected': -0.3279651701450348, 'epoch': 1.11}
{'loss': 0.4239, 'grad_norm': 3.520343065261841, 'learning_rate': 2.4589453096111003e-07, 'rewards/chosen': 0.0236558485776186, 'rewards/rejected': -1.1043473482131958, 'rewards/accuracies': 0.8262500166893005, 'rewards/margins': 1.1280031204223633, 'logps/chosen': -336.7322998046875, 'logps/rejected': -288.1792297363281, 'logits/chosen': -0.30009976029396057, 'logits/rejected': -0.3173467516899109, 'epoch': 1.14}
{'loss': 0.4225, 'grad_norm': 5.837570667266846, 'learning_rate': 2.3505298500691317e-07, 'rewards/chosen': 0.051340121775865555, 'rewards/rejected': -1.1176971197128296, 'rewards/accuracies': 0.8112499713897705, 'rewards/margins': 1.1690372228622437, 'logps/chosen': -316.4131774902344, 'logps/rejected': -276.21636962890625, 'logits/chosen': -0.2710345983505249, 'logits/rejected': -0.3470483422279358, 'epoch': 1.17}
{'eval_loss': 0.4401407539844513, 'eval_runtime': 939.6215, 'eval_samples_per_second': 3.242, 'eval_steps_per_second': 0.811, 'eval_rewards/chosen': 0.05310552194714546, 'eval_rewards/rejected': -1.0555179119110107, 'eval_rewards/accuracies': 0.8015092015266418, 'eval_rewards/margins': 1.1086236238479614, 'eval_logps/chosen': -326.86328125, 'eval_logps/rejected': -284.5255126953125, 'eval_logits/chosen': -0.2839325964450836, 'eval_logits/rejected': -0.33573415875434875, 'epoch': 1.17}
{'loss': 0.4262, 'grad_norm': 4.270340442657471, 'learning_rate': 2.243064243887297e-07, 'rewards/chosen': 0.12433593720197678, 'rewards/rejected': -1.0660910606384277, 'rewards/accuracies': 0.7950000166893005, 'rewards/margins': 1.1904269456863403, 'logps/chosen': -345.8901062011719, 'logps/rejected': -301.0108947753906, 'logits/chosen': -0.28556200861930847, 'logits/rejected': -0.3330049216747284, 'epoch': 1.2}
{'loss': 0.4293, 'grad_norm': 6.379944801330566, 'learning_rate': 2.13680402096476e-07, 'rewards/chosen': 0.06936430186033249, 'rewards/rejected': -1.0927637815475464, 'rewards/accuracies': 0.8075000047683716, 'rewards/margins': 1.1621280908584595, 'logps/chosen': -336.2305908203125, 'logps/rejected': -302.8562316894531, 'logits/chosen': -0.2634323239326477, 'logits/rejected': -0.32437843084335327, 'epoch': 1.23}
{'loss': 0.4456, 'grad_norm': 3.471748113632202, 'learning_rate': 2.0320018450607736e-07, 'rewards/chosen': 0.13292671740055084, 'rewards/rejected': -1.0452344417572021, 'rewards/accuracies': 0.8037499785423279, 'rewards/margins': 1.1781611442565918, 'logps/chosen': -325.1925048828125, 'logps/rejected': -288.67022705078125, 'logits/chosen': -0.3001301884651184, 'logits/rejected': -0.36459118127822876, 'epoch': 1.25}
{'loss': 0.4239, 'grad_norm': 5.167574882507324, 'learning_rate': 1.9289069130150743e-07, 'rewards/chosen': 0.14203715324401855, 'rewards/rejected': -1.0952160358428955, 'rewards/accuracies': 0.8062499761581421, 'rewards/margins': 1.237253189086914, 'logps/chosen': -331.463134765625, 'logps/rejected': -295.9638977050781, 'logits/chosen': -0.3030233085155487, 'logits/rejected': -0.366670161485672, 'epoch': 1.28}
{'loss': 0.414, 'grad_norm': 5.366117477416992, 'learning_rate': 1.8277643622118538e-07, 'rewards/chosen': 0.15898312628269196, 'rewards/rejected': -1.1045531034469604, 'rewards/accuracies': 0.824999988079071, 'rewards/margins': 1.2635363340377808, 'logps/chosen': -337.05078125, 'logps/rejected': -300.3495178222656, 'logits/chosen': -0.2878429591655731, 'logits/rejected': -0.33010753989219666, 'epoch': 1.31}
{'eval_loss': 0.43197500705718994, 'eval_runtime': 953.937, 'eval_samples_per_second': 3.193, 'eval_steps_per_second': 0.799, 'eval_rewards/chosen': 0.13742315769195557, 'eval_rewards/rejected': -1.0657012462615967, 'eval_rewards/accuracies': 0.8028215169906616, 'eval_rewards/margins': 1.2031244039535522, 'eval_logps/chosen': -326.0201110839844, 'eval_logps/rejected': -284.62738037109375, 'eval_logits/chosen': -0.2863580584526062, 'eval_logits/rejected': -0.33819395303726196, 'epoch': 1.31}
{'loss': 0.4479, 'grad_norm': 5.383135795593262, 'learning_rate': 1.7288146876962335e-07, 'rewards/chosen': 0.10125229507684708, 'rewards/rejected': -1.042219638824463, 'rewards/accuracies': 0.8050000071525574, 'rewards/margins': 1.1434720754623413, 'logps/chosen': -320.4449157714844, 'logps/rejected': -285.6133728027344, 'logits/chosen': -0.2781667411327362, 'logits/rejected': -0.3174154758453369, 'epoch': 1.34}
{'loss': 0.4284, 'grad_norm': 4.644858360290527, 'learning_rate': 1.6322931703292231e-07, 'rewards/chosen': 0.1486504226922989, 'rewards/rejected': -1.0659935474395752, 'rewards/accuracies': 0.8100000023841858, 'rewards/margins': 1.214643955230713, 'logps/chosen': -339.9717102050781, 'logps/rejected': -296.785400390625, 'logits/chosen': -0.31190478801727295, 'logits/rejected': -0.332017719745636, 'epoch': 1.37}
{'loss': 0.4282, 'grad_norm': 5.329451084136963, 'learning_rate': 1.538429317340867e-07, 'rewards/chosen': 0.1367597132921219, 'rewards/rejected': -1.1040583848953247, 'rewards/accuracies': 0.8125, 'rewards/margins': 1.2408180236816406, 'logps/chosen': -336.3814697265625, 'logps/rejected': -311.4328918457031, 'logits/chosen': -0.27198007702827454, 'logits/rejected': -0.33213943243026733, 'epoch': 1.4}
{'loss': 0.4166, 'grad_norm': 8.488852500915527, 'learning_rate': 1.44744631661184e-07, 'rewards/chosen': 0.20541243255138397, 'rewards/rejected': -1.0918813943862915, 'rewards/accuracies': 0.8100000023841858, 'rewards/margins': 1.2972936630249023, 'logps/chosen': -328.52581787109375, 'logps/rejected': -293.3746337890625, 'logits/chosen': -0.28105616569519043, 'logits/rejected': -0.3189519941806793, 'epoch': 1.43}
{'loss': 0.4023, 'grad_norm': 2.3099546432495117, 'learning_rate': 1.3595605059810828e-07, 'rewards/chosen': 0.19088859856128693, 'rewards/rejected': -1.1857383251190186, 'rewards/accuracies': 0.8075000047683716, 'rewards/margins': 1.3766268491744995, 'logps/chosen': -327.6864929199219, 'logps/rejected': -290.73504638671875, 'logits/chosen': -0.29335856437683105, 'logits/rejected': -0.33364421129226685, 'epoch': 1.46}
{'eval_loss': 0.4280300438404083, 'eval_runtime': 946.229, 'eval_samples_per_second': 3.219, 'eval_steps_per_second': 0.805, 'eval_rewards/chosen': 0.1758188158273697, 'eval_rewards/rejected': -1.0865981578826904, 'eval_rewards/accuracies': 0.8057742714881897, 'eval_rewards/margins': 1.2624168395996094, 'eval_logps/chosen': -325.63616943359375, 'eval_logps/rejected': -284.8363037109375, 'eval_logits/chosen': -0.28769737482070923, 'eval_logits/rejected': -0.33937034010887146, 'epoch': 1.46}
{'loss': 0.4146, 'grad_norm': 5.201714992523193, 'learning_rate': 1.2749808588413525e-07, 'rewards/chosen': 0.2678612470626831, 'rewards/rejected': -1.0356343984603882, 'rewards/accuracies': 0.8162500262260437, 'rewards/margins': 1.3034956455230713, 'logps/chosen': -334.2494812011719, 'logps/rejected': -290.8064880371094, 'logits/chosen': -0.31211522221565247, 'logits/rejected': -0.33621805906295776, 'epoch': 1.49}
 50%|█████     | 3427/6854 [6:10:43<4:06:01,  4.31s/it]wandb: WARNING URL not available in offline run
/root/miniconda3/envs/LLM/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
 55%|█████▍    | 3752/6854 [6:52:48<4:04:08,  4.72s/it]
{'loss': 0.4056, 'grad_norm': 5.758144855499268, 'learning_rate': 1.116536163707251e-07, 'rewards/chosen': 0.17014546692371368, 'rewards/rejected': -1.2159621715545654, 'rewards/accuracies': 0.8062499761581421, 'rewards/margins': 1.3861078023910522, 'logps/chosen': -334.8371887207031, 'logps/rejected': -293.321044921875, 'logits/chosen': -0.28517863154411316, 'logits/rejected': -0.3339342772960663, 'epoch': 1.55}
{'loss': 0.434, 'grad_norm': 5.02866268157959, 'learning_rate': 1.0430478628267625e-07, 'rewards/chosen': 0.21232075989246368, 'rewards/rejected': -1.082008719444275, 'rewards/accuracies': 0.7912499904632568, 'rewards/margins': 1.2943295240402222, 'logps/chosen': -342.81134033203125, 'logps/rejected': -297.0798034667969, 'logits/chosen': -0.27456584572792053, 'logits/rejected': -0.3407413959503174, 'epoch': 1.58}
{'loss': 0.419, 'grad_norm': 3.793861150741577, 'learning_rate': 9.73618323842154e-08, 'rewards/chosen': 0.1403336375951767, 'rewards/rejected': -1.197975516319275, 'rewards/accuracies': 0.8100000023841858, 'rewards/margins': 1.3383091688156128, 'logps/chosen': -330.41265869140625, 'logps/rejected': -289.9212646484375, 'logits/chosen': -0.2683519124984741, 'logits/rejected': -0.3327951729297638, 'epoch': 1.6}
{'eval_loss': 0.42589688301086426, 'eval_runtime': 903.1653, 'eval_samples_per_second': 3.373, 'eval_steps_per_second': 0.844, 'eval_rewards/chosen': 0.18821287155151367, 'eval_rewards/rejected': -1.1149570941925049, 'eval_rewards/accuracies': 0.8044619560241699, 'eval_rewards/margins': 1.3031699657440186, 'eval_logps/chosen': -325.5122375488281, 'eval_logps/rejected': -285.1199035644531, 'eval_logits/chosen': -0.28764575719833374, 'eval_logits/rejected': -0.3390708267688751, 'epoch': 1.6}
{'loss': 0.4069, 'grad_norm': 5.85543966293335, 'learning_rate': 9.084126351358955e-08, 'rewards/chosen': 0.20319053530693054, 'rewards/rejected': -1.1650702953338623, 'rewards/accuracies': 0.8137500286102295, 'rewards/margins': 1.3682608604431152, 'logps/chosen': -334.85906982421875, 'logps/rejected': -290.6571960449219, 'logits/chosen': -0.29073309898376465, 'logits/rejected': -0.31929951906204224, 'epoch': 1.63}
{'loss': 0.4295, 'grad_norm': 5.517396926879883, 'learning_rate': 8.475858416907672e-08, 'rewards/chosen': 0.15187905728816986, 'rewards/rejected': -1.1158339977264404, 'rewards/accuracies': 0.8025000095367432, 'rewards/margins': 1.2677130699157715, 'logps/chosen': -321.74627685546875, 'logps/rejected': -279.6875915527344, 'logits/chosen': -0.31126669049263, 'logits/rejected': -0.35146477818489075, 'epoch': 1.66}
{'loss': 0.4004, 'grad_norm': 5.784727096557617, 'learning_rate': 7.912825764265266e-08, 'rewards/chosen': 0.22341178357601166, 'rewards/rejected': -1.1942319869995117, 'rewards/accuracies': 0.8224999904632568, 'rewards/margins': 1.4176437854766846, 'logps/chosen': -328.4276123046875, 'logps/rejected': -280.2906799316406, 'logits/chosen': -0.29620179533958435, 'logits/rejected': -0.35867583751678467, 'epoch': 1.69}
{'loss': 0.4135, 'grad_norm': 5.630998611450195, 'learning_rate': 7.396367162941966e-08, 'rewards/chosen': 0.22454704344272614, 'rewards/rejected': -1.2251170873641968, 'rewards/accuracies': 0.8174999952316284, 'rewards/margins': 1.4496639966964722, 'logps/chosen': -332.2481994628906, 'logps/rejected': -298.87371826171875, 'logits/chosen': -0.25868308544158936, 'logits/rejected': -0.29042330384254456, 'epoch': 1.72}
{'loss': 0.4253, 'grad_norm': 5.414799690246582, 'learning_rate': 6.927710639457207e-08, 'rewards/chosen': 0.16797810792922974, 'rewards/rejected': -1.1713863611221313, 'rewards/accuracies': 0.8050000071525574, 'rewards/margins': 1.3393646478652954, 'logps/chosen': -325.5482482910156, 'logps/rejected': -295.7355041503906, 'logits/chosen': -0.2566206157207489, 'logits/rejected': -0.3228590488433838, 'epoch': 1.75}
{'eval_loss': 0.42390012741088867, 'eval_runtime': 343.2869, 'eval_samples_per_second': 8.873, 'eval_steps_per_second': 2.22, 'eval_rewards/chosen': 0.206821471452713, 'eval_rewards/rejected': -1.122554063796997, 'eval_rewards/accuracies': 0.807414710521698, 'eval_rewards/margins': 1.3293753862380981, 'eval_logps/chosen': -325.32611083984375, 'eval_logps/rejected': -285.19586181640625, 'eval_logits/chosen': -0.2883271276950836, 'eval_logits/rejected': -0.33974093198776245, 'epoch': 1.75}
{'loss': 0.4104, 'grad_norm': 5.057709693908691, 'learning_rate': 6.507970557358947e-08, 'rewards/chosen': 0.19478023052215576, 'rewards/rejected': -1.175561785697937, 'rewards/accuracies': 0.824999988079071, 'rewards/margins': 1.3703418970108032, 'logps/chosen': -325.2842102050781, 'logps/rejected': -278.11102294921875, 'logits/chosen': -0.28469082713127136, 'logits/rejected': -0.32991623878479004, 'epoch': 1.78}
{'loss': 0.4481, 'grad_norm': 3.9823153018951416, 'learning_rate': 6.138144967508889e-08, 'rewards/chosen': 0.14907655119895935, 'rewards/rejected': -1.1032902002334595, 'rewards/accuracies': 0.7850000262260437, 'rewards/margins': 1.2523667812347412, 'logps/chosen': -319.84515380859375, 'logps/rejected': -291.3151550292969, 'logits/chosen': -0.30124905705451965, 'logits/rejected': -0.34645548462867737, 'epoch': 1.81}
{'loss': 0.4261, 'grad_norm': 4.740198612213135, 'learning_rate': 5.819113234934041e-08, 'rewards/chosen': 0.24981984496116638, 'rewards/rejected': -1.153640866279602, 'rewards/accuracies': 0.8012499809265137, 'rewards/margins': 1.4034607410430908, 'logps/chosen': -351.446533203125, 'logps/rejected': -291.1604309082031, 'logits/chosen': -0.3340602219104767, 'logits/rejected': -0.34623587131500244, 'epoch': 1.84}
{'loss': 0.3936, 'grad_norm': 4.3045759201049805, 'learning_rate': 5.551633947887435e-08, 'rewards/chosen': 0.25454533100128174, 'rewards/rejected': -1.1660734415054321, 'rewards/accuracies': 0.8075000047683716, 'rewards/margins': 1.4206187725067139, 'logps/chosen': -328.8040771484375, 'logps/rejected': -291.34930419921875, 'logits/chosen': -0.2946394979953766, 'logits/rejected': -0.3449152708053589, 'epoch': 1.87}
{'loss': 0.4505, 'grad_norm': 6.123305797576904, 'learning_rate': 5.336343114089831e-08, 'rewards/chosen': 0.1983938068151474, 'rewards/rejected': -1.0969605445861816, 'rewards/accuracies': 0.7950000166893005, 'rewards/margins': 1.2953546047210693, 'logps/chosen': -316.3804016113281, 'logps/rejected': -297.0301818847656, 'logits/chosen': -0.33020591735839844, 'logits/rejected': -0.3703930675983429, 'epoch': 1.9}
{'eval_loss': 0.4234953224658966, 'eval_runtime': 920.8933, 'eval_samples_per_second': 3.308, 'eval_steps_per_second': 0.827, 'eval_rewards/chosen': 0.20608456432819366, 'eval_rewards/rejected': -1.1369609832763672, 'eval_rewards/accuracies': 0.805446207523346, 'eval_rewards/margins': 1.3430455923080444, 'eval_logps/chosen': -325.33349609375, 'eval_logps/rejected': -285.3399353027344, 'eval_logits/chosen': -0.2893175482749939, 'eval_logits/rejected': -0.3407973647117615, 'epoch': 1.9}
{'loss': 0.4186, 'grad_norm': 5.898388385772705, 'learning_rate': 5.1737526484413104e-08, 'rewards/chosen': 0.24210210144519806, 'rewards/rejected': -1.2090253829956055, 'rewards/accuracies': 0.8174999952316284, 'rewards/margins': 1.451127529144287, 'logps/chosen': -343.567626953125, 'logps/rejected': -291.68878173828125, 'logits/chosen': -0.3072129189968109, 'logits/rejected': -0.3474721610546112, 'epoch': 1.93}
{'loss': 0.4394, 'grad_norm': 5.734900951385498, 'learning_rate': 5.064249155798705e-08, 'rewards/chosen': 0.24017944931983948, 'rewards/rejected': -1.104899525642395, 'rewards/accuracies': 0.8062499761581421, 'rewards/margins': 1.3450790643692017, 'logps/chosen': -316.073974609375, 'logps/rejected': -298.13604736328125, 'logits/chosen': -0.3145714998245239, 'logits/rejected': -0.3212607502937317, 'epoch': 1.96}
{'loss': 0.4196, 'grad_norm': 2.574430465698242, 'learning_rate': 5.008093011713104e-08, 'rewards/chosen': 0.2423669844865799, 'rewards/rejected': -1.1010993719100952, 'rewards/accuracies': 0.8037499785423279, 'rewards/margins': 1.3434665203094482, 'logps/chosen': -330.2286071777344, 'logps/rejected': -313.5831604003906, 'logits/chosen': -0.2944088280200958, 'logits/rejected': -0.3396313488483429, 'epoch': 1.98}
{'train_runtime': 42070.6625, 'train_samples_per_second': 1.303, 'train_steps_per_second': 0.163, 'train_loss': 0.4952966193607398, 'epoch': 2.0}
Working Time: 11:41:43
100%|██████████| 6854/6854 [11:41:06<00:00,  4.35s/it]wandb: WARNING URL not available in offline run
100%|██████████| 6854/6854 [11:41:10<00:00,  6.14s/it]