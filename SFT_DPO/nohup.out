/root/miniconda3/envs/LLM/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
  warnings.warn(
/root/miniconda3/envs/LLM/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:10,  3.52s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:07<00:07,  3.53s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:10<00:03,  3.51s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:10<00:00,  2.22s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:10<00:00,  2.70s/it]
/root/miniconda3/envs/LLM/lib/python3.12/site-packages/peft/mapping_func.py:73: UserWarning: You are trying to modify a model with PEFT for a second time. If you want to reload the model with a different config, make sure to call `.unload()` before.
  warnings.warn(
/root/miniconda3/envs/LLM/lib/python3.12/site-packages/peft/tuners/tuners_utils.py:196: UserWarning: Already found a `peft_config` attribute in the model. This will lead to having multiple adapters in the model. Make sure to know what you are doing!
  warnings.warn(
The tokenizer has new PAD/BOS/EOS tokens that differ from the model config and generation config. The model config and generation config were aligned accordingly, being updated with the tokenizer's values. Updated tokens: {'eos_token_id': 128009, 'pad_token_id': 128009}.
wandb: Tracking run with wandb version 0.22.2
wandb: W&B syncing is set to `offline` in this directory. Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
wandb: Run data is saved locally in /root/HFRL/SFT_DPO/wandb/offline-run-20251026_142436-99t8wmzk
wandb: Detected [huggingface_hub.inference, openai] in use.
wandb: Use W&B Weave for improved LLM call tracing. Install Weave with `pip install weave` then add `import weave` to the top of your script.
wandb: For more information, check out the docs at: https://weave-docs.wandb.ai/
  0%|          | 0/6854 [00:00<?, ?it/s]Casting fp32 inputs back to torch.bfloat16 for flash-attn compatibility.
/root/miniconda3/envs/LLM/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  0%|          | 1/6854 [00:06<12:45:24,  6.70s/it]  0%|          | 2/6854 [00:11<10:37:40,  5.58s/it]  0%|          | 3/6854 [00:16<10:17:24,  5.41s/it]  0%|          | 4/6854 [00:21<10:08:48,  5.33s/it]  0%|          | 5/6854 [00:26<9:37:53,  5.06s/it]   0%|          | 6/6854 [00:31<9:39:09,  5.07s/it]  0%|          | 7/6854 [00:36<9:36:13,  5.05s/it]  0%|          | 8/6854 [00:42<10:04:25,  5.30s/it]  0%|          | 9/6854 [00:47<9:51:51,  5.19s/it]   0%|          | 10/6854 [00:51<9:21:20,  4.92s/it]  0%|          | 11/6854 [00:57<9:41:14,  5.10s/it]  0%|          | 12/6854 [01:02<9:51:35,  5.19s/it]  0%|          | 13/6854 [01:07<9:40:03,  5.09s/it]  0%|          | 14/6854 [01:13<10:01:48,  5.28s/it]  0%|          | 15/6854 [01:17<9:41:15,  5.10s/it]   0%|          | 16/6854 [01:22<9:33:16,  5.03s/it]  0%|          | 17/6854 [01:28<9:56:01,  5.23s/it]  0%|          | 18/6854 [01:33<9:34:14,  5.04s/it]  0%|          | 19/6854 [01:38<9:34:05,  5.04s/it]  0%|          | 20/6854 [01:42<9:29:46,  5.00s/it]  0%|          | 21/6854 [01:47<9:09:50,  4.83s/it]  0%|          | 22/6854 [01:52<9:27:55,  4.99s/it]  0%|          | 23/6854 [01:57<9:34:32,  5.05s/it]  0%|          | 24/6854 [02:02<9:24:30,  4.96s/it]  0%|          | 25/6854 [02:07<9:34:18,  5.05s/it]  0%|          | 26/6854 [02:13<10:05:16,  5.32s/it]  0%|          | 27/6854 [02:19<10:09:56,  5.36s/it]  0%|          | 28/6854 [02:24<10:16:26,  5.42s/it]  0%|          | 29/6854 [02:29<9:38:40,  5.09s/it]   0%|          | 30/6854 [02:34<9:52:19,  5.21s/it]  0%|          | 31/6854 [02:39<9:53:31,  5.22s/it]  0%|          | 32/6854 [02:44<9:45:14,  5.15s/it]  0%|          | 33/6854 [02:49<9:18:29,  4.91s/it]  0%|          | 34/6854 [02:54<9:28:22,  5.00s/it]  1%|          | 35/6854 [02:59<9:31:53,  5.03s/it]  1%|          | 36/6854 [03:04<9:13:28,  4.87s/it]  1%|          | 37/6854 [03:08<9:06:16,  4.81s/it]  1%|          | 38/6854 [03:13<9:18:43,  4.92s/it]  1%|          | 39/6854 [03:18<9:21:25,  4.94s/it]  1%|          | 40/6854 [03:24<9:34:43,  5.06s/it]  1%|          | 41/6854 [03:29<9:41:47,  5.12s/it]  1%|          | 42/6854 [03:34<9:36:28,  5.08s/it]  1%|          | 43/6854 [03:40<9:59:16,  5.28s/it]  1%|          | 44/6854 [03:45<9:48:25,  5.18s/it]  1%|          | 45/6854 [03:49<9:20:19,  4.94s/it]  1%|          | 46/6854 [03:54<9:27:00,  5.00s/it]  1%|          | 47/6854 [04:00<9:39:24,  5.11s/it]  1%|          | 48/6854 [04:05<9:41:48,  5.13s/it]  1%|          | 49/6854 [04:10<9:40:47,  5.12s/it]  1%|          | 50/6854 [04:15<9:36:45,  5.09s/it]  1%|          | 51/6854 [04:20<9:41:42,  5.13s/it]  1%|          | 52/6854 [04:25<9:39:31,  5.11s/it]  1%|          | 53/6854 [04:31<9:50:43,  5.21s/it]  1%|          | 54/6854 [04:35<9:27:05,  5.00s/it]  1%|          | 55/6854 [04:40<9:14:23,  4.89s/it]  1%|          | 56/6854 [04:45<9:31:02,  5.04s/it]  1%|          | 57/6854 [04:50<9:29:05,  5.02s/it]  1%|          | 58/6854 [04:55<9:25:35,  4.99s/it]  1%|          | 59/6854 [05:00<9:30:38,  5.04s/it]  1%|          | 60/6854 [05:05<9:36:05,  5.09s/it]  1%|          | 61/6854 [05:11<9:54:39,  5.25s/it]  1%|          | 62/6854 [05:17<10:18:30,  5.46s/it]  1%|          | 63/6854 [05:23<10:27:59,  5.55s/it]  1%|          | 64/6854 [05:27<9:57:18,  5.28s/it]   1%|          | 65/6854 [05:32<9:41:53,  5.14s/it]  1%|          | 66/6854 [05:37<9:38:25,  5.11s/it]  1%|          | 67/6854 [05:41<9:04:41,  4.82s/it]  1%|          | 68/6854 [05:46<8:58:23,  4.76s/it]  1%|          | 69/6854 [05:52<9:38:09,  5.11s/it]  1%|          | 70/6854 [05:57<9:39:13,  5.12s/it]  1%|          | 71/6854 [06:01<9:01:02,  4.79s/it]  1%|          | 72/6854 [06:06<8:48:49,  4.68s/it]  1%|          | 73/6854 [06:11<9:03:57,  4.81s/it]  1%|          | 74/6854 [06:14<8:27:56,  4.50s/it]  1%|          | 75/6854 [06:19<8:33:44,  4.55s/it]  1%|          | 76/6854 [06:24<8:37:54,  4.58s/it]  1%|          | 77/6854 [06:29<8:44:28,  4.64s/it]  1%|          | 78/6854 [06:33<8:30:40,  4.52s/it]  1%|          | 79/6854 [06:38<8:58:19,  4.77s/it]  1%|          | 80/6854 [06:43<8:51:12,  4.71s/it]  1%|          | 81/6854 [06:47<8:49:51,  4.69s/it]  1%|          | 82/6854 [06:52<9:02:21,  4.81s/it]  1%|          | 83/6854 [06:58<9:16:06,  4.93s/it]  1%|          | 84/6854 [07:02<8:59:35,  4.78s/it]  1%|          | 85/6854 [07:07<8:58:45,  4.78s/it]  1%|▏         | 86/6854 [07:11<8:42:26,  4.63s/it]  1%|▏         | 87/6854 [07:16<8:36:32,  4.58s/it]  1%|▏         | 88/6854 [07:20<8:46:11,  4.67s/it]  1%|▏         | 89/6854 [07:26<9:04:50,  4.83s/it]  1%|▏         | 90/6854 [07:31<9:23:06,  5.00s/it]  1%|▏         | 91/6854 [07:36<9:17:30,  4.95s/it]  1%|▏         | 92/6854 [07:42<10:09:14,  5.41s/it]  1%|▏         | 93/6854 [07:47<9:39:02,  5.14s/it]   1%|▏         | 94/6854 [07:52<9:25:59,  5.02s/it]  1%|▏         | 95/6854 [07:59<10:31:24,  5.61s/it]  1%|▏         | 96/6854 [08:04<10:35:46,  5.64s/it]  1%|▏         | 97/6854 [08:10<10:43:43,  5.72s/it]  1%|▏         | 98/6854 [08:16<10:38:37,  5.67s/it]  1%|▏         | 99/6854 [08:21<10:08:53,  5.41s/it]  1%|▏         | 100/6854 [08:26<9:57:07,  5.30s/it]                                                      1%|▏         | 100/6854 [08:26<9:57:07,  5.30s/it]  1%|▏         | 101/6854 [08:31<10:07:13,  5.40s/it]  1%|▏         | 102/6854 [08:36<9:51:10,  5.25s/it]   2%|▏         | 103/6854 [08:42<10:07:42,  5.40s/it]  2%|▏         | 104/6854 [08:47<9:55:34,  5.29s/it]   2%|▏         | 105/6854 [08:52<9:37:30,  5.13s/it]  2%|▏         | 106/6854 [08:56<9:21:25,  4.99s/it]  2%|▏         | 107/6854 [09:01<9:23:11,  5.01s/it]  2%|▏         | 108/6854 [09:07<9:42:03,  5.18s/it]  2%|▏         | 109/6854 [09:12<9:39:31,  5.16s/it]  2%|▏         | 110/6854 [09:16<9:09:33,  4.89s/it]  2%|▏         | 111/6854 [09:21<9:17:37,  4.96s/it]  2%|▏         | 112/6854 [09:27<9:40:45,  5.17s/it]  2%|▏         | 113/6854 [09:32<9:24:31,  5.02s/it]  2%|▏         | 114/6854 [09:37<9:39:03,  5.15s/it]  2%|▏         | 115/6854 [09:43<9:49:31,  5.25s/it]  2%|▏         | 116/6854 [09:47<9:30:20,  5.08s/it]  2%|▏         | 117/6854 [09:53<9:43:23,  5.20s/it]  2%|▏         | 118/6854 [09:58<9:40:45,  5.17s/it]  2%|▏         | 119/6854 [10:03<9:30:53,  5.09s/it]  2%|▏         | 120/6854 [10:07<9:05:43,  4.86s/it]  2%|▏         | 121/6854 [10:12<8:51:26,  4.74s/it]  2%|▏         | 122/6854 [10:16<8:52:33,  4.75s/it]  2%|▏         | 123/6854 [10:22<9:03:08,  4.84s/it]  2%|▏         | 124/6854 [10:26<8:57:30,  4.79s/it]  2%|▏         | 125/6854 [10:32<9:25:59,  5.05s/it]  2%|▏         | 126/6854 [10:39<10:36:55,  5.68s/it]  2%|▏         | 127/6854 [10:44<10:27:20,  5.60s/it]  2%|▏         | 128/6854 [10:50<10:16:29,  5.50s/it]  2%|▏         | 129/6854 [10:54<9:46:05,  5.23s/it]   2%|▏         | 130/6854 [11:00<9:53:45,  5.30s/it]  2%|▏         | 131/6854 [11:04<9:21:18,  5.01s/it]  2%|▏         | 132/6854 [11:09<9:32:13,  5.11s/it]  2%|▏         | 133/6854 [11:15<9:33:10,  5.12s/it]  2%|▏         | 134/6854 [11:20<9:56:59,  5.33s/it]  2%|▏         | 135/6854 [11:25<9:34:40,  5.13s/it]  2%|▏         | 136/6854 [11:30<9:18:02,  4.98s/it]  2%|▏         | 137/6854 [11:34<9:06:54,  4.89s/it]  2%|▏         | 138/6854 [11:40<9:42:37,  5.21s/it]  2%|▏         | 139/6854 [11:45<9:28:48,  5.08s/it]  2%|▏         | 140/6854 [11:49<8:41:20,  4.66s/it]  2%|▏         | 141/6854 [11:54<8:59:09,  4.82s/it]  2%|▏         | 142/6854 [11:59<9:14:41,  4.96s/it]  2%|▏         | 143/6854 [12:05<9:27:07,  5.07s/it]  2%|▏         | 144/6854 [12:09<9:10:06,  4.92s/it]  2%|▏         | 145/6854 [12:14<9:00:02,  4.83s/it]  2%|▏         | 146/6854 [12:20<9:57:23,  5.34s/it]  2%|▏         | 147/6854 [12:26<10:04:27,  5.41s/it]  2%|▏         | 148/6854 [12:31<9:42:36,  5.21s/it]   2%|▏         | 149/6854 [12:36<9:38:30,  5.18s/it]  2%|▏         | 150/6854 [12:41<9:39:26,  5.19s/it]  2%|▏         | 151/6854 [12:46<9:46:08,  5.25s/it]  2%|▏         | 152/6854 [12:51<9:34:02,  5.14s/it]  2%|▏         | 153/6854 [12:56<9:39:37,  5.19s/it]  2%|▏         | 154/6854 [13:02<10:02:04,  5.39s/it]  2%|▏         | 155/6854 [13:06<9:11:52,  4.94s/it]   2%|▏         | 156/6854 [13:08<7:38:07,  4.10s/it]  2%|▏         | 157/6854 [13:11<6:32:15,  3.51s/it]  2%|▏         | 158/6854 [13:13<5:45:59,  3.10s/it]  2%|▏         | 159/6854 [13:14<5:03:13,  2.72s/it]  2%|▏         | 160/6854 [13:16<4:35:17,  2.47s/it]  2%|▏         | 161/6854 [13:20<5:19:11,  2.86s/it]  2%|▏         | 162/6854 [13:25<6:29:36,  3.49s/it]  2%|▏         | 163/6854 [13:31<7:36:07,  4.09s/it]  2%|▏         | 164/6854 [13:36<8:12:37,  4.42s/it]