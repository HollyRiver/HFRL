wandb: Detected [huggingface_hub.inference, openai] in use.
wandb: Use W&B Weave for improved LLM call tracing. Install Weave with `pip install weave` then add `import weave` to the top of your script.
wandb: For more information, check out the docs at: https://weave-docs.wandb.ai/
Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.54s/it]
Tokenizing train dataset: 100%|██████████| 27413/27413 [00:40<00:00, 682.41 examples/s]
Tokenizing eval dataset: 100%|██████████| 3046/3046 [00:03<00:00, 974.88 examples/s]
The tokenizer has new PAD/BOS/EOS tokens that differ from the model config and generation config. The model config and generation config were aligned accordingly, being updated with the tokenizer's values. Updated tokens: {'eos_token_id': 128009, 'pad_token_id': 128009}.
  0%|          | 0/6854 [00:00<?, ?it/s]/root/miniconda3/envs/LLM/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|▏         | 100/6854 [02:56<3:18:11,  1.76s/it]
{'loss': 0.6918, 'grad_norm': 16.948091506958008, 'learning_rate': 1.2014563106796117e-07, 'rewards/chosen': 0.006472588051110506, 'rewards/rejected': 0.0017359359189867973, 'rewards/accuracies': 0.5337499976158142, 'rewards/margins': 0.004736652597784996, 'logps/chosen': -312.8955383300781, 'logps/rejected': -234.5526123046875, 'logits/chosen': 0.15779170393943787, 'logits/rejected': 0.22377224266529083, 'epoch': 0.03}
{'loss': 0.6842, 'grad_norm': 14.05918025970459, 'learning_rate': 2.4150485436893205e-07, 'rewards/chosen': 0.023605134338140488, 'rewards/rejected': 0.0034597991034388542, 'rewards/accuracies': 0.5899999737739563, 'rewards/margins': 0.02014533430337906, 'logps/chosen': -285.2123718261719, 'logps/rejected': -242.08741760253906, 'logits/chosen': 0.12651455402374268, 'logits/rejected': 0.22273597121238708, 'epoch': 0.06}
{'loss': 0.669, 'grad_norm': 12.111315727233887, 'learning_rate': 3.6286407766990293e-07, 'rewards/chosen': 0.04874178767204285, 'rewards/rejected': -0.004466033075004816, 'rewards/accuracies': 0.6787499785423279, 'rewards/margins': 0.053207818418741226, 'logps/chosen': -289.6886291503906, 'logps/rejected': -228.89682006835938, 'logits/chosen': 0.16101142764091492, 'logits/rejected': 0.23736979067325592, 'epoch': 0.09}
{'loss': 0.6538, 'grad_norm': 13.992389678955078, 'learning_rate': 4.842233009708738e-07, 'rewards/chosen': 0.08100755512714386, 'rewards/rejected': -0.006598464213311672, 'rewards/accuracies': 0.71875, 'rewards/margins': 0.0876060277223587, 'logps/chosen': -287.8227233886719, 'logps/rejected': -243.5858917236328, 'logits/chosen': 0.1362798660993576, 'logits/rejected': 0.191813662648201, 'epoch': 0.12}
{'loss': 0.6243, 'grad_norm': 12.188263893127441, 'learning_rate': 4.997975190436907e-07, 'rewards/chosen': 0.12761887907981873, 'rewards/rejected': -0.02874176762998104, 'rewards/accuracies': 0.768750011920929, 'rewards/margins': 0.15636064112186432, 'logps/chosen': -296.9980773925781, 'logps/rejected': -239.83180236816406, 'logits/chosen': 0.11978066712617874, 'logits/rejected': 0.18950742483139038, 'epoch': 0.15}
{'loss': 0.609, 'grad_norm': 11.158562660217285, 'learning_rate': 4.99065039993038e-07, 'rewards/chosen': 0.13975790143013, 'rewards/rejected': -0.05961838737130165, 'rewards/accuracies': 0.7875000238418579, 'rewards/margins': 0.19937628507614136, 'logps/chosen': -296.3459167480469, 'logps/rejected': -235.0863800048828, 'logits/chosen': 0.12214870750904083, 'logits/rejected': 0.17898207902908325, 'epoch': 0.18}
{'loss': 0.5957, 'grad_norm': 13.475914001464844, 'learning_rate': 4.97799782883342e-07, 'rewards/chosen': 0.13018691539764404, 'rewards/rejected': -0.11176540702581406, 'rewards/accuracies': 0.7762500047683716, 'rewards/margins': 0.2419523000717163, 'logps/chosen': -285.82794189453125, 'logps/rejected': -246.27407836914062, 'logits/chosen': 0.13690586388111115, 'logits/rejected': 0.19821153581142426, 'epoch': 0.2}
{'loss': 0.5758, 'grad_norm': 13.900797843933105, 'learning_rate': 4.960047562215398e-07, 'rewards/chosen': 0.1391337513923645, 'rewards/rejected': -0.15721918642520905, 'rewards/accuracies': 0.7950000166893005, 'rewards/margins': 0.29635295271873474, 'logps/chosen': -291.120849609375, 'logps/rejected': -229.4276123046875, 'logits/chosen': 0.11431412398815155, 'logits/rejected': 0.1654392033815384, 'epoch': 0.23}
{'loss': 0.5659, 'grad_norm': 8.806530952453613, 'learning_rate': 4.936842281916408e-07, 'rewards/chosen': 0.1006658673286438, 'rewards/rejected': -0.22418330609798431, 'rewards/accuracies': 0.7887499928474426, 'rewards/margins': 0.3248491585254669, 'logps/chosen': -279.7359619140625, 'logps/rejected': -232.65487670898438, 'logits/chosen': 0.11636927723884583, 'logits/rejected': 0.17122992873191833, 'epoch': 0.26}
{'loss': 0.5482, 'grad_norm': 9.092156410217285, 'learning_rate': 4.908437165059117e-07, 'rewards/chosen': 0.09358915686607361, 'rewards/rejected': -0.29569751024246216, 'rewards/accuracies': 0.7724999785423279, 'rewards/margins': 0.3892866373062134, 'logps/chosen': -291.3885803222656, 'logps/rejected': -232.5594482421875, 'logits/chosen': 0.10698835551738739, 'logits/rejected': 0.17216724157333374, 'epoch': 0.29}
{'loss': 0.5332, 'grad_norm': 12.170337677001953, 'learning_rate': 4.874899752849537e-07, 'rewards/chosen': 0.07673811167478561, 'rewards/rejected': -0.3614760637283325, 'rewards/accuracies': 0.8062499761581421, 'rewards/margins': 0.43821415305137634, 'logps/chosen': -308.993408203125, 'logps/rejected': -254.08445739746094, 'logits/chosen': 0.1180911660194397, 'logits/rejected': 0.14626160264015198, 'epoch': 0.32}
{'loss': 0.5189, 'grad_norm': 10.640161514282227, 'learning_rate': 4.836309789978688e-07, 'rewards/chosen': 0.04713425785303116, 'rewards/rejected': -0.4369099736213684, 'rewards/accuracies': 0.8187500238418579, 'rewards/margins': 0.48404422402381897, 'logps/chosen': -283.66937255859375, 'logps/rejected': -226.9727020263672, 'logits/chosen': 0.11661110818386078, 'logits/rejected': 0.1596842110157013, 'epoch': 0.35}
{'loss': 0.5237, 'grad_norm': 8.363972663879395, 'learning_rate': 4.792759035007018e-07, 'rewards/chosen': 0.027681009843945503, 'rewards/rejected': -0.4674544930458069, 'rewards/accuracies': 0.7887499928474426, 'rewards/margins': 0.4951355457305908, 'logps/chosen': -278.2481384277344, 'logps/rejected': -218.38771057128906, 'logits/chosen': 0.07391028106212616, 'logits/rejected': 0.13169673085212708, 'epoch': 0.38}
{'loss': 0.5147, 'grad_norm': 9.702509880065918, 'learning_rate': 4.744351042182457e-07, 'rewards/chosen': -0.00923351664096117, 'rewards/rejected': -0.5322932004928589, 'rewards/accuracies': 0.8025000095367432, 'rewards/margins': 0.5230596661567688, 'logps/chosen': -295.42462158203125, 'logps/rejected': -244.6776580810547, 'logits/chosen': 0.10299484431743622, 'logits/rejected': 0.13931865990161896, 'epoch': 0.41}
{'loss': 0.5113, 'grad_norm': 9.094314575195312, 'learning_rate': 4.691200915210875e-07, 'rewards/chosen': -0.029317500069737434, 'rewards/rejected': -0.5811939239501953, 'rewards/accuracies': 0.7962499856948853, 'rewards/margins': 0.551876425743103, 'logps/chosen': -270.9059753417969, 'logps/rejected': -246.43675231933594, 'logits/chosen': 0.09711768478155136, 'logits/rejected': 0.13246525824069977, 'epoch': 0.44}
{'loss': 0.4792, 'grad_norm': 9.57193660736084, 'learning_rate': 4.633435033564442e-07, 'rewards/chosen': -0.031948186457157135, 'rewards/rejected': -0.7101020216941833, 'rewards/accuracies': 0.8137500286102295, 'rewards/margins': 0.6781538128852844, 'logps/chosen': -308.4065246582031, 'logps/rejected': -243.70333862304688, 'logits/chosen': 0.09307736158370972, 'logits/rejected': 0.14078760147094727, 'epoch': 0.47}
{'loss': 0.4853, 'grad_norm': 11.063641548156738, 'learning_rate': 4.5711907519786535e-07, 'rewards/chosen': -0.11695278435945511, 'rewards/rejected': -0.7663870453834534, 'rewards/accuracies': 0.8062499761581421, 'rewards/margins': 0.6494343280792236, 'logps/chosen': -284.5452880859375, 'logps/rejected': -243.66552734375, 'logits/chosen': 0.10121315717697144, 'logits/rejected': 0.13970547914505005, 'epoch': 0.5}
{'loss': 0.4874, 'grad_norm': 10.000213623046875, 'learning_rate': 4.504616073852573e-07, 'rewards/chosen': -0.1531185805797577, 'rewards/rejected': -0.8333266377449036, 'rewards/accuracies': 0.7900000214576721, 'rewards/margins': 0.6802080273628235, 'logps/chosen': -294.4413146972656, 'logps/rejected': -246.61915588378906, 'logits/chosen': 0.08392121642827988, 'logits/rejected': 0.11416973173618317, 'epoch': 0.53}
{'loss': 0.4817, 'grad_norm': 11.100720405578613, 'learning_rate': 4.433869299328848e-07, 'rewards/chosen': -0.15637576580047607, 'rewards/rejected': -0.8415367007255554, 'rewards/accuracies': 0.7962499856948853, 'rewards/margins': 0.6851609945297241, 'logps/chosen': -277.99505615234375, 'logps/rejected': -234.0811767578125, 'logits/chosen': 0.07557789981365204, 'logits/rejected': 0.1061835065484047, 'epoch': 0.55}
{'loss': 0.4706, 'grad_norm': 11.884926795959473, 'learning_rate': 4.359118648890314e-07, 'rewards/chosen': -0.16907081007957458, 'rewards/rejected': -0.900413990020752, 'rewards/accuracies': 0.8025000095367432, 'rewards/margins': 0.7313430309295654, 'logps/chosen': -306.0449523925781, 'logps/rejected': -261.40936279296875, 'logits/chosen': 0.09145746380090714, 'logits/rejected': 0.11054074019193649, 'epoch': 0.58}
{'loss': 0.4659, 'grad_norm': 7.769370079040527, 'learning_rate': 4.28054186336818e-07, 'rewards/chosen': -0.1792946308851242, 'rewards/rejected': -0.9585345387458801, 'rewards/accuracies': 0.8025000095367432, 'rewards/margins': 0.7792400121688843, 'logps/chosen': -301.08270263671875, 'logps/rejected': -250.49774169921875, 'logits/chosen': 0.07179532200098038, 'logits/rejected': 0.08208686858415604, 'epoch': 0.61}
{'loss': 0.4606, 'grad_norm': 13.757757186889648, 'learning_rate': 4.1983257813128836e-07, 'rewards/chosen': -0.22080068290233612, 'rewards/rejected': -1.0125973224639893, 'rewards/accuracies': 0.7962499856948853, 'rewards/margins': 0.7917967438697815, 'logps/chosen': -291.98193359375, 'logps/rejected': -246.2149658203125, 'logits/chosen': 0.040050212293863297, 'logits/rejected': 0.09488645195960999, 'epoch': 0.64}
{'loss': 0.4691, 'grad_norm': 10.81258487701416, 'learning_rate': 4.112665894732553e-07, 'rewards/chosen': -0.25351497530937195, 'rewards/rejected': -1.0222597122192383, 'rewards/accuracies': 0.8100000023841858, 'rewards/margins': 0.7687448263168335, 'logps/chosen': -279.1064147949219, 'logps/rejected': -245.97850036621094, 'logits/chosen': 0.04403126612305641, 'logits/rejected': 0.0925406664609909, 'epoch': 0.67}
{'loss': 0.4471, 'grad_norm': 9.299457550048828, 'learning_rate': 4.023765884255418e-07, 'rewards/chosen': -0.23444804549217224, 'rewards/rejected': -1.1080694198608398, 'rewards/accuracies': 0.8062499761581421, 'rewards/margins': 0.8736213445663452, 'logps/chosen': -306.976806640625, 'logps/rejected': -256.4101257324219, 'logits/chosen': 0.07744354009628296, 'logits/rejected': 0.12177439779043198, 'epoch': 0.7}
{'loss': 0.4443, 'grad_norm': 8.503366470336914, 'learning_rate': 3.931837134821461e-07, 'rewards/chosen': -0.2189790904521942, 'rewards/rejected': -1.1176592111587524, 'rewards/accuracies': 0.8012499809265137, 'rewards/margins': 0.8986800909042358, 'logps/chosen': -299.05389404296875, 'logps/rejected': -251.3751220703125, 'logits/chosen': 0.040224723517894745, 'logits/rejected': 0.08771441131830215, 'epoch': 0.73}
{'loss': 0.4184, 'grad_norm': 16.51094627380371, 'learning_rate': 3.8370982330548824e-07, 'rewards/chosen': -0.20362436771392822, 'rewards/rejected': -1.1699877977371216, 'rewards/accuracies': 0.8487499952316284, 'rewards/margins': 0.9663633704185486, 'logps/chosen': -294.05145263671875, 'logps/rejected': -242.11758422851562, 'logits/chosen': 0.06181197986006737, 'logits/rejected': 0.10134641826152802, 'epoch': 0.76}
{'loss': 0.48, 'grad_norm': 14.289311408996582, 'learning_rate': 3.73977444751253e-07, 'rewards/chosen': -0.3164917826652527, 'rewards/rejected': -1.1570247411727905, 'rewards/accuracies': 0.7799999713897705, 'rewards/margins': 0.8405328392982483, 'logps/chosen': -289.6680908203125, 'logps/rejected': -235.5101776123047, 'logits/chosen': 0.05207924544811249, 'logits/rejected': 0.048071857541799545, 'epoch': 0.79}
{'loss': 0.4563, 'grad_norm': 25.36433219909668, 'learning_rate': 3.640097193044135e-07, 'rewards/chosen': -0.328134685754776, 'rewards/rejected': -1.2400974035263062, 'rewards/accuracies': 0.8062499761581421, 'rewards/margins': 0.9119627475738525, 'logps/chosen': -284.04571533203125, 'logps/rejected': -240.11093139648438, 'logits/chosen': 0.07148511707782745, 'logits/rejected': 0.08085060864686966, 'epoch': 0.82}
{'loss': 0.4393, 'grad_norm': 11.735483169555664, 'learning_rate': 3.538303480538e-07, 'rewards/chosen': -0.3361758291721344, 'rewards/rejected': -1.3069943189620972, 'rewards/accuracies': 0.8025000095367432, 'rewards/margins': 0.9708184599876404, 'logps/chosen': -289.48114013671875, 'logps/rejected': -243.67601013183594, 'logits/chosen': 0.04292380437254906, 'logits/rejected': 0.08788514882326126, 'epoch': 0.85}
{'loss': 0.4677, 'grad_norm': 11.274063110351562, 'learning_rate': 3.4346353533605227e-07, 'rewards/chosen': -0.35026630759239197, 'rewards/rejected': -1.2550435066223145, 'rewards/accuracies': 0.78125, 'rewards/margins': 0.9047772288322449, 'logps/chosen': -293.1241455078125, 'logps/rejected': -241.7627716064453, 'logits/chosen': 0.03423309698700905, 'logits/rejected': 0.06688281893730164, 'epoch': 0.88}
{'loss': 0.4527, 'grad_norm': 5.992591857910156, 'learning_rate': 3.329339311829574e-07, 'rewards/chosen': -0.3823031485080719, 'rewards/rejected': -1.3353580236434937, 'rewards/accuracies': 0.7900000214576721, 'rewards/margins': 0.953054666519165, 'logps/chosen': -288.7580261230469, 'logps/rejected': -237.4778289794922, 'logits/chosen': 0.0534401498734951, 'logits/rejected': 0.09254424273967743, 'epoch': 0.9}
{'loss': 0.4284, 'grad_norm': 14.503390312194824, 'learning_rate': 3.222665727090218e-07, 'rewards/chosen': -0.32395657896995544, 'rewards/rejected': -1.3923163414001465, 'rewards/accuracies': 0.824999988079071, 'rewards/margins': 1.0683598518371582, 'logps/chosen': -287.3730773925781, 'logps/rejected': -240.61984252929688, 'logits/chosen': 0.022772209718823433, 'logits/rejected': 0.044106122106313705, 'epoch': 0.93}
{'loss': 0.4255, 'grad_norm': 12.879694938659668, 'learning_rate': 3.1148682457864395e-07, 'rewards/chosen': -0.37417057156562805, 'rewards/rejected': -1.422641396522522, 'rewards/accuracies': 0.8224999904632568, 'rewards/margins': 1.0484709739685059, 'logps/chosen': -292.5047912597656, 'logps/rejected': -242.1283416748047, 'logits/chosen': 0.06006159633398056, 'logits/rejected': 0.07014866918325424, 'epoch': 0.96}
 50%|█████     | 3427/6854 [1:43:22<1:40:35,  1.76s/it]
100%|██████████| 762/762 [04:49<00:00,  2.42it/s]
{'eval_loss': 0.4388205409049988, 'eval_runtime': 290.7196, 'eval_samples_per_second': 10.477, 'eval_steps_per_second': 2.621, 'eval_rewards/chosen': -0.4117034673690796, 'eval_rewards/rejected': -1.438186764717102, 'eval_rewards/accuracies': 0.7946194410324097, 'eval_rewards/margins': 1.026483178138733, 'eval_logps/chosen': -288.9578857421875, 'eval_logps/rejected': -240.82872009277344, 'eval_logits/chosen': 0.046447254717350006, 'eval_logits/rejected': 0.06206534802913666, 'epoch': 1.0}
{'loss': 0.4174, 'grad_norm': 7.427897930145264, 'learning_rate': 2.896928932501641e-07, 'rewards/chosen': -0.41911810636520386, 'rewards/rejected': -1.4978677034378052, 'rewards/accuracies': 0.8162500262260437, 'rewards/margins': 1.0787495374679565, 'logps/chosen': -295.8448791503906, 'logps/rejected': -253.58030700683594, 'logits/chosen': 0.023480668663978577, 'logits/rejected': 0.0628548189997673, 'epoch': 1.02}
{'loss': 0.4051, 'grad_norm': 13.296314239501953, 'learning_rate': 2.7873053129303955e-07, 'rewards/chosen': -0.3006608784198761, 'rewards/rejected': -1.477683424949646, 'rewards/accuracies': 0.8362500071525574, 'rewards/margins': 1.1770225763320923, 'logps/chosen': -299.4998474121094, 'logps/rejected': -255.79588317871094, 'logits/chosen': 0.029375068843364716, 'logits/rejected': 0.06423963606357574, 'epoch': 1.05}
{'loss': 0.4043, 'grad_norm': 11.410126686096191, 'learning_rate': 2.67759298941758e-07, 'rewards/chosen': -0.36393195390701294, 'rewards/rejected': -1.4965896606445312, 'rewards/accuracies': 0.8299999833106995, 'rewards/margins': 1.1326576471328735, 'logps/chosen': -297.58758544921875, 'logps/rejected': -254.53468322753906, 'logits/chosen': -0.003544547827914357, 'logits/rejected': 0.03452647104859352, 'epoch': 1.08}
{'loss': 0.3935, 'grad_norm': 5.656593322753906, 'learning_rate': 2.568052834068798e-07, 'rewards/chosen': -0.3913392126560211, 'rewards/rejected': -1.5872122049331665, 'rewards/accuracies': 0.8500000238418579, 'rewards/margins': 1.1958731412887573, 'logps/chosen': -292.01666259765625, 'logps/rejected': -259.6708984375, 'logits/chosen': 0.011595753021538258, 'logits/rejected': 0.0371723473072052, 'epoch': 1.11}
{'loss': 0.3919, 'grad_norm': 7.572245121002197, 'learning_rate': 2.4589453096111003e-07, 'rewards/chosen': -0.40718886256217957, 'rewards/rejected': -1.6059609651565552, 'rewards/accuracies': 0.8349999785423279, 'rewards/margins': 1.1987723112106323, 'logps/chosen': -299.9021301269531, 'logps/rejected': -240.9326934814453, 'logits/chosen': 0.027875233441591263, 'logits/rejected': 0.056827958673238754, 'epoch': 1.14}
{'loss': 0.3946, 'grad_norm': 13.131768226623535, 'learning_rate': 2.3505298500691317e-07, 'rewards/chosen': -0.41568565368652344, 'rewards/rejected': -1.631179690361023, 'rewards/accuracies': 0.8299999833106995, 'rewards/margins': 1.2154940366744995, 'logps/chosen': -279.9625244140625, 'logps/rejected': -234.63595581054688, 'logits/chosen': 0.02615426294505596, 'logits/rejected': 0.014774143695831299, 'epoch': 1.17}
{'loss': 0.3932, 'grad_norm': 6.423223495483398, 'learning_rate': 2.243064243887297e-07, 'rewards/chosen': -0.40362438559532166, 'rewards/rejected': -1.6568951606750488, 'rewards/accuracies': 0.8224999904632568, 'rewards/margins': 1.2532707452774048, 'logps/chosen': -307.5462951660156, 'logps/rejected': -256.5259094238281, 'logits/chosen': 0.028584495186805725, 'logits/rejected': 0.06222675368189812, 'epoch': 1.2}
{'loss': 0.4107, 'grad_norm': 13.925047874450684, 'learning_rate': 2.13680402096476e-07, 'rewards/chosen': -0.4451442062854767, 'rewards/rejected': -1.6340115070343018, 'rewards/accuracies': 0.8149999976158142, 'rewards/margins': 1.1888675689697266, 'logps/chosen': -301.60675048828125, 'logps/rejected': -263.1203918457031, 'logits/chosen': 0.03683929145336151, 'logits/rejected': 0.04819110780954361, 'epoch': 1.23}
{'loss': 0.4134, 'grad_norm': 4.928100109100342, 'learning_rate': 2.0320018450607736e-07, 'rewards/chosen': -0.44090452790260315, 'rewards/rejected': -1.6295031309127808, 'rewards/accuracies': 0.8287500143051147, 'rewards/margins': 1.1885987520217896, 'logps/chosen': -290.4969787597656, 'logps/rejected': -246.7934112548828, 'logits/chosen': 0.015312058851122856, 'logits/rejected': 0.02709057554602623, 'epoch': 1.25}
{'loss': 0.3951, 'grad_norm': 6.48379373550415, 'learning_rate': 1.9289069130150743e-07, 'rewards/chosen': -0.3996981084346771, 'rewards/rejected': -1.6389881372451782, 'rewards/accuracies': 0.8224999904632568, 'rewards/margins': 1.2392901182174683, 'logps/chosen': -298.035400390625, 'logps/rejected': -255.09124755859375, 'logits/chosen': 0.012195365503430367, 'logits/rejected': 0.009680584073066711, 'epoch': 1.28}
{'loss': 0.3875, 'grad_norm': 9.161104202270508, 'learning_rate': 1.8277643622118538e-07, 'rewards/chosen': -0.3962821066379547, 'rewards/rejected': -1.6604533195495605, 'rewards/accuracies': 0.8500000238418579, 'rewards/margins': 1.2641712427139282, 'logps/chosen': -302.245849609375, 'logps/rejected': -255.4610595703125, 'logits/chosen': 0.028949640691280365, 'logits/rejected': 0.05601632595062256, 'epoch': 1.31}
{'loss': 0.4244, 'grad_norm': 12.441482543945312, 'learning_rate': 1.7288146876962335e-07, 'rewards/chosen': -0.48386964201927185, 'rewards/rejected': -1.6436793804168701, 'rewards/accuracies': 0.8100000023841858, 'rewards/margins': 1.1598097085952759, 'logps/chosen': -287.7729187011719, 'logps/rejected': -245.14956665039062, 'logits/chosen': 0.015520445071160793, 'logits/rejected': 0.046785492449998856, 'epoch': 1.34}
{'loss': 0.3897, 'grad_norm': 13.402697563171387, 'learning_rate': 1.6322931703292231e-07, 'rewards/chosen': -0.46561580896377563, 'rewards/rejected': -1.6804717779159546, 'rewards/accuracies': 0.8475000262260437, 'rewards/margins': 1.2148560285568237, 'logps/chosen': -302.3770751953125, 'logps/rejected': -256.0552978515625, 'logits/chosen': 0.010025757364928722, 'logits/rejected': 0.028497686609625816, 'epoch': 1.37}
{'loss': 0.4126, 'grad_norm': 5.883669853210449, 'learning_rate': 1.538429317340867e-07, 'rewards/chosen': -0.5149728655815125, 'rewards/rejected': -1.700081467628479, 'rewards/accuracies': 0.8149999976158142, 'rewards/margins': 1.1851085424423218, 'logps/chosen': -296.31475830078125, 'logps/rejected': -266.402587890625, 'logits/chosen': 0.03240448236465454, 'logits/rejected': 0.05282239988446236, 'epoch': 1.4}
{'loss': 0.3794, 'grad_norm': 15.059959411621094, 'learning_rate': 1.44744631661184e-07, 'rewards/chosen': -0.4373958706855774, 'rewards/rejected': -1.7493679523468018, 'rewards/accuracies': 0.8424999713897705, 'rewards/margins': 1.3119720220565796, 'logps/chosen': -292.1268005371094, 'logps/rejected': -251.47019958496094, 'logits/chosen': 0.012587607838213444, 'logits/rejected': 0.050612397491931915, 'epoch': 1.43}
{'loss': 0.3804, 'grad_norm': 8.314718246459961, 'learning_rate': 1.3595605059810828e-07, 'rewards/chosen': -0.46669554710388184, 'rewards/rejected': -1.8078625202178955, 'rewards/accuracies': 0.8362500071525574, 'rewards/margins': 1.3411669731140137, 'logps/chosen': -292.5320129394531, 'logps/rejected': -249.53579711914062, 'logits/chosen': 0.02569073624908924, 'logits/rejected': 0.04681511968374252, 'epoch': 1.46}
{'loss': 0.3724, 'grad_norm': 15.530557632446289, 'learning_rate': 1.2749808588413525e-07, 'rewards/chosen': -0.4073256254196167, 'rewards/rejected': -1.7344751358032227, 'rewards/accuracies': 0.8475000262260437, 'rewards/margins': 1.327149510383606, 'logps/chosen': -299.474853515625, 'logps/rejected': -252.42066955566406, 'logits/chosen': -0.004319946747273207, 'logits/rejected': 0.031081516295671463, 'epoch': 1.49}
{'loss': 0.383, 'grad_norm': 8.193164825439453, 'learning_rate': 1.1939084872458226e-07, 'rewards/chosen': -0.4705822467803955, 'rewards/rejected': -1.8327850103378296, 'rewards/accuracies': 0.8324999809265137, 'rewards/margins': 1.362202763557434, 'logps/chosen': -292.42315673828125, 'logps/rejected': -235.60337829589844, 'logits/chosen': -0.010644089430570602, 'logits/rejected': 0.005588429048657417, 'epoch': 1.52}
{'loss': 0.3747, 'grad_norm': 10.674474716186523, 'learning_rate': 1.116536163707251e-07, 'rewards/chosen': -0.5041143894195557, 'rewards/rejected': -1.809869647026062, 'rewards/accuracies': 0.8487499952316284, 'rewards/margins': 1.3057551383972168, 'logps/chosen': -301.3224182128906, 'logps/rejected': -250.6174774169922, 'logits/chosen': 0.017003601416945457, 'logits/rejected': 0.01659436710178852, 'epoch': 1.55}
{'loss': 0.4103, 'grad_norm': 9.598462104797363, 'learning_rate': 1.0430478628267625e-07, 'rewards/chosen': -0.42574676871299744, 'rewards/rejected': -1.7124855518341064, 'rewards/accuracies': 0.8237500190734863, 'rewards/margins': 1.2867388725280762, 'logps/chosen': -304.0135803222656, 'logps/rejected': -255.36154174804688, 'logits/chosen': 0.026522522792220116, 'logits/rejected': 0.026254551485180855, 'epoch': 1.58}
{'loss': 0.392, 'grad_norm': 6.459813117980957, 'learning_rate': 9.73618323842154e-08, 'rewards/chosen': -0.5433419942855835, 'rewards/rejected': -1.8569620847702026, 'rewards/accuracies': 0.8299999833106995, 'rewards/margins': 1.3136199712753296, 'logps/chosen': -293.75213623046875, 'logps/rejected': -251.02740478515625, 'logits/chosen': 0.035638224333524704, 'logits/rejected': 0.04020219296216965, 'epoch': 1.6}
{'loss': 0.3842, 'grad_norm': 11.259112358093262, 'learning_rate': 9.084126351358955e-08, 'rewards/chosen': -0.46908748149871826, 'rewards/rejected': -1.8478975296020508, 'rewards/accuracies': 0.8274999856948853, 'rewards/margins': 1.378810167312622, 'logps/chosen': -300.645263671875, 'logps/rejected': -252.31610107421875, 'logits/chosen': 0.004219609312713146, 'logits/rejected': 0.04501219093799591, 'epoch': 1.63}
{'loss': 0.419, 'grad_norm': 12.74940013885498, 'learning_rate': 8.475858416907672e-08, 'rewards/chosen': -0.5517548322677612, 'rewards/rejected': -1.7401280403137207, 'rewards/accuracies': 0.8025000095367432, 'rewards/margins': 1.18837308883667, 'logps/chosen': -285.79766845703125, 'logps/rejected': -239.09596252441406, 'logits/chosen': 0.0010054648155346513, 'logits/rejected': 0.036711107939481735, 'epoch': 1.66}
{'loss': 0.3777, 'grad_norm': 12.730486869812012, 'learning_rate': 7.912825764265266e-08, 'rewards/chosen': -0.5070757865905762, 'rewards/rejected': -1.8460966348648071, 'rewards/accuracies': 0.8500000238418579, 'rewards/margins': 1.3390209674835205, 'logps/chosen': -291.37506103515625, 'logps/rejected': -239.9551544189453, 'logits/chosen': 0.01094798929989338, 'logits/rejected': 0.014827024191617966, 'epoch': 1.69}
{'loss': 0.3796, 'grad_norm': 12.113588333129883, 'learning_rate': 7.396367162941966e-08, 'rewards/chosen': -0.45562049746513367, 'rewards/rejected': -1.8505051136016846, 'rewards/accuracies': 0.84375, 'rewards/margins': 1.3948848247528076, 'logps/chosen': -297.6697082519531, 'logps/rejected': -257.0602722167969, 'logits/chosen': 0.024346813559532166, 'logits/rejected': 0.04680776596069336, 'epoch': 1.72}
{'loss': 0.3932, 'grad_norm': 11.792549133300781, 'learning_rate': 6.927710639457207e-08, 'rewards/chosen': -0.5263791680335999, 'rewards/rejected': -1.8268543481826782, 'rewards/accuracies': 0.8274999856948853, 'rewards/margins': 1.3004751205444336, 'logps/chosen': -289.1091003417969, 'logps/rejected': -255.38742065429688, 'logits/chosen': 0.01898995228111744, 'logits/rejected': 0.03568272665143013, 'epoch': 1.75}
{'loss': 0.3979, 'grad_norm': 10.567455291748047, 'learning_rate': 6.507970557358947e-08, 'rewards/chosen': -0.5007871985435486, 'rewards/rejected': -1.8276828527450562, 'rewards/accuracies': 0.8199999928474426, 'rewards/margins': 1.3268957138061523, 'logps/chosen': -289.3689270019531, 'logps/rejected': -239.68162536621094, 'logits/chosen': 0.00815015472471714, 'logits/rejected': 0.03328882157802582, 'epoch': 1.78}
{'loss': 0.4194, 'grad_norm': 9.408331871032715, 'learning_rate': 6.138144967508889e-08, 'rewards/chosen': -0.5306708812713623, 'rewards/rejected': -1.7387226819992065, 'rewards/accuracies': 0.8162500262260437, 'rewards/margins': 1.2080518007278442, 'logps/chosen': -286.1054992675781, 'logps/rejected': -250.62725830078125, 'logits/chosen': -0.002564909402281046, 'logits/rejected': 0.011811938136816025, 'epoch': 1.81}
{'loss': 0.4021, 'grad_norm': 10.053853988647461, 'learning_rate': 5.819113234934041e-08, 'rewards/chosen': -0.48959600925445557, 'rewards/rejected': -1.8360768556594849, 'rewards/accuracies': 0.8174999952316284, 'rewards/margins': 1.3464807271957397, 'logps/chosen': -316.2958068847656, 'logps/rejected': -250.52947998046875, 'logits/chosen': -0.014546966180205345, 'logits/rejected': 0.020694026723504066, 'epoch': 1.84}
{'loss': 0.3812, 'grad_norm': 9.146465301513672, 'learning_rate': 5.551633947887435e-08, 'rewards/chosen': -0.4453909695148468, 'rewards/rejected': -1.8128973245620728, 'rewards/accuracies': 0.8512499928474426, 'rewards/margins': 1.3675063848495483, 'logps/chosen': -295.3609619140625, 'logps/rejected': -250.4615478515625, 'logits/chosen': 0.0010910301934927702, 'logits/rejected': 0.02805975452065468, 'epoch': 1.87}
{'loss': 0.4032, 'grad_norm': 9.65960693359375, 'learning_rate': 5.336343114089831e-08, 'rewards/chosen': -0.4901380240917206, 'rewards/rejected': -1.7622944116592407, 'rewards/accuracies': 0.8087499737739563, 'rewards/margins': 1.2721564769744873, 'logps/chosen': -281.7176208496094, 'logps/rejected': -258.8128967285156, 'logits/chosen': -0.017716385424137115, 'logits/rejected': 0.00854541640728712, 'epoch': 1.9}
{'loss': 0.3893, 'grad_norm': 10.680704116821289, 'learning_rate': 5.1737526484413104e-08, 'rewards/chosen': -0.4687434732913971, 'rewards/rejected': -1.8781273365020752, 'rewards/accuracies': 0.8262500166893005, 'rewards/margins': 1.4093836545944214, 'logps/chosen': -309.27716064453125, 'logps/rejected': -248.92596435546875, 'logits/chosen': 0.0019864654168486595, 'logits/rejected': 0.005258406978100538, 'epoch': 1.93}
{'loss': 0.3979, 'grad_norm': 10.480257987976074, 'learning_rate': 5.064249155798705e-08, 'rewards/chosen': -0.5062049627304077, 'rewards/rejected': -1.7883394956588745, 'rewards/accuracies': 0.8199999928474426, 'rewards/margins': 1.2821346521377563, 'logps/chosen': -285.5280456542969, 'logps/rejected': -255.4066925048828, 'logits/chosen': 0.002897462574765086, 'logits/rejected': 0.033048115670681, 'epoch': 1.96}
{'loss': 0.3998, 'grad_norm': 5.279720783233643, 'learning_rate': 5.008093011713104e-08, 'rewards/chosen': -0.5177267789840698, 'rewards/rejected': -1.7902075052261353, 'rewards/accuracies': 0.824999988079071, 'rewards/margins': 1.2724807262420654, 'logps/chosen': -297.090576171875, 'logps/rejected': -270.61260986328125, 'logits/chosen': 0.012946493923664093, 'logits/rejected': 0.01356431283056736, 'epoch': 1.98}
{'eval_loss': 0.4204503893852234, 'eval_runtime': 309.1242, 'eval_samples_per_second': 9.854, 'eval_steps_per_second': 2.465, 'eval_rewards/chosen': -0.5673196315765381, 'eval_rewards/rejected': -1.8022427558898926, 'eval_rewards/accuracies': 0.8021653294563293, 'eval_rewards/margins': 1.2349231243133545, 'eval_logps/chosen': -290.5140380859375, 'eval_logps/rejected': -244.4692840576172, 'eval_logits/chosen': 0.016091112047433853, 'eval_logits/rejected': 0.02710714377462864, 'epoch': 2.0}
{'train_runtime': 13017.0894, 'train_samples_per_second': 4.212, 'train_steps_per_second': 0.527, 'train_loss': 0.4548051253609035, 'epoch': 2.0}
Working Time: 3:38:21
/root/miniconda3/envs/LLM/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
100%|██████████| 6854/6854 [3:36:52<00:00,  1.69swandb: WARNING URL not available in offline run
100%|██████████| 6854/6854 [3:36:57<00:00,  1.90s/it]