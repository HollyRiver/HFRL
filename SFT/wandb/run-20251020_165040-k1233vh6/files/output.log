  0%|          | 0/4752 [00:00<?, ?it/s]Casting fp32 inputs back to torch.bfloat16 for flash-attn compatibility.
                                                       
{'loss': 1.9759, 'grad_norm': 0.26727887988090515, 'learning_rate': 3.461538461538462e-05, 'entropy': 2.106837424635887, 'num_tokens': 674600.0, 'mean_token_accuracy': 0.5965798061341048, 'epoch': 0.08}
{'loss': 1.2134, 'grad_norm': 0.2688583433628082, 'learning_rate': 4.983626547081478e-05, 'entropy': 1.3844511723518371, 'num_tokens': 1346111.0, 'mean_token_accuracy': 0.738489031791687, 'epoch': 0.17}
{'loss': 1.1766, 'grad_norm': 0.2574441432952881, 'learning_rate': 4.873874734038467e-05, 'entropy': 1.3331826475262643, 'num_tokens': 2018321.0, 'mean_token_accuracy': 0.7430497701466083, 'epoch': 0.25}
{'loss': 1.1659, 'grad_norm': 0.29543840885162354, 'learning_rate': 4.66520549993109e-05, 'entropy': 1.3152632761001586, 'num_tokens': 2698628.0, 'mean_token_accuracy': 0.7432860952615737, 'epoch': 0.34}
{'loss': 1.1594, 'grad_norm': 0.27352744340896606, 'learning_rate': 4.3663139212928354e-05, 'entropy': 1.2984390270709991, 'num_tokens': 3375668.0, 'mean_token_accuracy': 0.743987402021885, 'epoch': 0.42}
{'loss': 1.1437, 'grad_norm': 0.29278305172920227, 'learning_rate': 3.989654566055541e-05, 'entropy': 1.2802367578446865, 'num_tokens': 4048364.0, 'mean_token_accuracy': 0.7468366526067257, 'epoch': 0.51}
{'loss': 1.1375, 'grad_norm': 0.312467098236084, 'learning_rate': 3.5509225218772026e-05, 'entropy': 1.2750454252958299, 'num_tokens': 4719186.0, 'mean_token_accuracy': 0.7461649352312087, 'epoch': 0.59}
{'loss': 1.1407, 'grad_norm': 0.30746373534202576, 'learning_rate': 3.0683993946598255e-05, 'entropy': 1.2843892757594586, 'num_tokens': 5393979.0, 'mean_token_accuracy': 0.7451695995032788, 'epoch': 0.67}
{'loss': 1.1293, 'grad_norm': 0.296631783246994, 'learning_rate': 2.562191528964844e-05, 'entropy': 1.2742862595617772, 'num_tokens': 6064966.0, 'mean_token_accuracy': 0.7462442515790463, 'epoch': 0.76}
{'loss': 1.1367, 'grad_norm': 0.29893264174461365, 'learning_rate': 2.0533921930591386e-05, 'entropy': 1.2811044430732728, 'num_tokens': 6738474.0, 'mean_token_accuracy': 0.7448556652665138, 'epoch': 0.84}
{'loss': 1.1253, 'grad_norm': 0.2914826571941376, 'learning_rate': 1.563202639656423e-05, 'entropy': 1.2672471478581429, 'num_tokens': 7415522.0, 'mean_token_accuracy': 0.7459980295598507, 'epoch': 0.93}
{'loss': 1.1153, 'grad_norm': 0.32148662209510803, 'learning_rate': 1.1120486670349433e-05, 'entropy': 1.2549727523237242, 'num_tokens': 8082978.0, 'mean_token_accuracy': 0.7485601075908594, 'epoch': 1.01}
{'loss': 1.1176, 'grad_norm': 0.31579145789146423, 'learning_rate': 7.187294927080604e-06, 'entropy': 1.2572692331671715, 'num_tokens': 8757250.0, 'mean_token_accuracy': 0.7482049818336963, 'epoch': 1.09}
{'loss': 1.1246, 'grad_norm': 0.2959005534648895, 'learning_rate': 3.99634405386636e-06, 'entropy': 1.2652640192210673, 'num_tokens': 9432483.0, 'mean_token_accuracy': 0.7462990571558475, 'epoch': 1.18}
{'loss': 1.116, 'grad_norm': 0.3126010298728943, 'learning_rate': 1.6805983670607068e-06, 'entropy': 1.256942734271288, 'num_tokens': 10103170.0, 'mean_token_accuracy': 0.747803581058979, 'epoch': 1.26}
{'loss': 1.0965, 'grad_norm': 0.338944673538208, 'learning_rate': 3.36553097812603e-07, 'entropy': 1.2355285601317882, 'num_tokens': 10773917.0, 'mean_token_accuracy': 0.7513532510399819, 'epoch': 1.35}
{'loss': 1.1129, 'grad_norm': 0.33724555373191833, 'learning_rate': 4.99797864853937e-05, 'entropy': 1.2491252630949021, 'num_tokens': 11444982.0, 'mean_token_accuracy': 0.7485785672068596, 'epoch': 1.43}
{'loss': 1.1188, 'grad_norm': 0.3129260838031769, 'learning_rate': 4.9255238770528436e-05, 'entropy': 1.253110906034708, 'num_tokens': 12120167.0, 'mean_token_accuracy': 0.7470492281019687, 'epoch': 1.52}
{'loss': 1.1185, 'grad_norm': 0.321216344833374, 'learning_rate': 4.7519995069022206e-05, 'entropy': 1.2553352281451224, 'num_tokens': 12796187.0, 'mean_token_accuracy': 0.7476085887849331, 'epoch': 1.6}
{'loss': 1.1195, 'grad_norm': 0.31884706020355225, 'learning_rate': 4.484636156848043e-05, 'entropy': 1.2500498804450035, 'num_tokens': 13471476.0, 'mean_token_accuracy': 0.7476134045422077, 'epoch': 1.68}
{'loss': 1.1092, 'grad_norm': 0.333871454000473, 'learning_rate': 4.13457463929093e-05, 'entropy': 1.238378547281027, 'num_tokens': 14142498.0, 'mean_token_accuracy': 0.749423168450594, 'epoch': 1.77}
{'loss': 1.1099, 'grad_norm': 0.29646992683410645, 'learning_rate': 3.716401731719225e-05, 'entropy': 1.238234875202179, 'num_tokens': 14815555.0, 'mean_token_accuracy': 0.7484536130726337, 'epoch': 1.85}
{'loss': 1.1209, 'grad_norm': 0.31077906489372253, 'learning_rate': 3.247542357606298e-05, 'entropy': 1.2463421073555947, 'num_tokens': 15492265.0, 'mean_token_accuracy': 0.7463587807118892, 'epoch': 1.94}
{'loss': 1.1124, 'grad_norm': 0.2994575798511505, 'learning_rate': 2.7475335040829753e-05, 'entropy': 1.2382805320553314, 'num_tokens': 16163825.0, 'mean_token_accuracy': 0.7479875274469381, 'epoch': 2.02}
{'loss': 1.1025, 'grad_norm': 0.29665452241897583, 'learning_rate': 2.2372101316426167e-05, 'entropy': 1.2285940261185169, 'num_tokens': 16834512.0, 'mean_token_accuracy': 0.749721472710371, 'epoch': 2.1}
{'loss': 1.1132, 'grad_norm': 0.3085910677909851, 'learning_rate': 1.7378369983564258e-05, 'entropy': 1.2361579497158528, 'num_tokens': 17511357.0, 'mean_token_accuracy': 0.7484517475962639, 'epoch': 2.19}
{'loss': 1.1011, 'grad_norm': 0.3325212597846985, 'learning_rate': 1.270222574774771e-05, 'entropy': 1.2251870803534985, 'num_tokens': 18187693.0, 'mean_token_accuracy': 0.7503198669850826, 'epoch': 2.27}
{'loss': 1.102, 'grad_norm': 0.3194952607154846, 'learning_rate': 8.538519719567767e-06, 'entropy': 1.2248635336756706, 'num_tokens': 18862795.0, 'mean_token_accuracy': 0.7498649293184281, 'epoch': 2.36}
{'loss': 1.0921, 'grad_norm': 0.31457391381263733, 'learning_rate': 5.060750128089409e-06, 'entropy': 1.2139068713784218, 'num_tokens': 19532018.0, 'mean_token_accuracy': 0.7523939803242683, 'epoch': 2.44}
{'loss': 1.1057, 'grad_norm': 0.31970641016960144, 'learning_rate': 2.413832791368431e-06, 'entropy': 1.230619946271181, 'num_tokens': 20208087.0, 'mean_token_accuracy': 0.7494828863441945, 'epoch': 2.53}
{'loss': 1.0897, 'grad_norm': 0.31363335251808167, 'learning_rate': 7.080625926876971e-07, 'entropy': 1.2129751244187355, 'num_tokens': 20874784.0, 'mean_token_accuracy': 0.7521812178194522, 'epoch': 2.61}
{'loss': 1.1113, 'grad_norm': 0.3321537971496582, 'learning_rate': 1.451758286538929e-08, 'entropy': 1.2314242294430733, 'num_tokens': 21552941.0, 'mean_token_accuracy': 0.7480679646134376, 'epoch': 2.69}
{'loss': 1.106, 'grad_norm': 0.3104619085788727, 'learning_rate': 4.963790278406245e-05, 'entropy': 1.2300018261373042, 'num_tokens': 22226428.0, 'mean_token_accuracy': 0.7494505621492863, 'epoch': 2.78}
{'loss': 1.1048, 'grad_norm': 0.3139895796775818, 'learning_rate': 4.8263681867485e-05, 'entropy': 1.2287980623543262, 'num_tokens': 22900366.0, 'mean_token_accuracy': 0.7493316940963268, 'epoch': 2.86}
{'loss': 1.1028, 'grad_norm': 0.304737389087677, 'learning_rate': 4.59200823304617e-05, 'entropy': 1.2266125218570232, 'num_tokens': 23575392.0, 'mean_token_accuracy': 0.7497611552476883, 'epoch': 2.95}
{'loss': 1.0974, 'grad_norm': 0.3129521310329437, 'learning_rate': 4.270476005132765e-05, 'entropy': 1.2190336455079847, 'num_tokens': 24246963.0, 'mean_token_accuracy': 0.7506837985270602, 'epoch': 3.03}
{'loss': 1.1039, 'grad_norm': 0.31390324234962463, 'learning_rate': 3.875169488301369e-05, 'entropy': 1.2233042000234127, 'num_tokens': 24921839.0, 'mean_token_accuracy': 0.7494380468130112, 'epoch': 3.11}
{'loss': 1.0916, 'grad_norm': 0.30768445134162903, 'learning_rate': 3.422560782201642e-05, 'entropy': 1.2121023119986056, 'num_tokens': 25595008.0, 'mean_token_accuracy': 0.7518195195496082, 'epoch': 3.2}
{'loss': 1.0938, 'grad_norm': 0.33399516344070435, 'learning_rate': 2.9315097219026882e-05, 'entropy': 1.2107613544166087, 'num_tokens': 26269002.0, 'mean_token_accuracy': 0.7513872773945331, 'epoch': 3.28}
{'loss': 1.0922, 'grad_norm': 0.3202217221260071, 'learning_rate': 2.4224780039713872e-05, 'entropy': 1.210939844250679, 'num_tokens': 26938836.0, 'mean_token_accuracy': 0.7522911310195923, 'epoch': 3.37}
{'loss': 1.0999, 'grad_norm': 0.31777235865592957, 'learning_rate': 1.916676564290644e-05, 'entropy': 1.2204353980720044, 'num_tokens': 27616903.0, 'mean_token_accuracy': 0.7503282280266285, 'epoch': 3.45}
{'loss': 1.0884, 'grad_norm': 0.32681336998939514, 'learning_rate': 1.4351817356873192e-05, 'entropy': 1.2060913778841496, 'num_tokens': 28285993.0, 'mean_token_accuracy': 0.7520150664448738, 'epoch': 3.54}
{'loss': 1.0867, 'grad_norm': 0.3119664490222931, 'learning_rate': 9.980570143595571e-06, 'entropy': 1.2020577700436115, 'num_tokens': 28958950.0, 'mean_token_accuracy': 0.7523969095945359, 'epoch': 3.62}
{'loss': 1.0899, 'grad_norm': 0.31129926443099976, 'learning_rate': 6.2351703037913155e-06, 'entropy': 1.2052924455702305, 'num_tokens': 29632418.0, 'mean_token_accuracy': 0.7513563834130764, 'epoch': 3.7}
{'loss': 1.0898, 'grad_norm': 0.343966007232666, 'learning_rate': 3.2716855893497324e-06, 'entropy': 1.2074882209300994, 'num_tokens': 30305029.0, 'mean_token_accuracy': 0.7522030484676361, 'epoch': 3.79}
{'loss': 1.0999, 'grad_norm': 0.3026975095272064, 'learning_rate': 1.2136019875948035e-06, 'entropy': 1.216073330640793, 'num_tokens': 30983183.0, 'mean_token_accuracy': 0.749133905917406, 'epoch': 3.87}
{'loss': 1.095, 'grad_norm': 0.33057987689971924, 'learning_rate': 1.466781610631185e-07, 'entropy': 1.2109190420806408, 'num_tokens': 31656437.0, 'mean_token_accuracy': 0.7511717088520526, 'epoch': 3.96}
{'train_runtime': 8953.5813, 'train_samples_per_second': 8.49, 'train_steps_per_second': 0.531, 'train_loss': 1.132574160091002, 'entropy': 1.199224052509824, 'num_tokens': 32005020.0, 'mean_token_accuracy': 0.75212947441184, 'epoch': 4.0}
